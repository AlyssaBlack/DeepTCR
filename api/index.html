<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>API reference - DeepTCR</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "API reference";
    var mkdocs_page_input_path = "api.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> DeepTCR</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">API reference</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_base">DeepTCR_base</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_base.__init__">__init__()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_base.__init__--initialize-training-object">Initialize Training Object.</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_base.Get_Data">Get_Data()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_base.Get_Data--get-data-for-deeptcr">Get Data for DeepTCR</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_base.Load_Data">Load_Data()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_base.Load_Data--load-data-programatically-into-deeptcr">Load Data programatically into DeepTCR.</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_base.Sequence_Inference">Sequence_Inference()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_base.Sequence_Inference--predicting-outputs-of-sequence-models-on-new-data">Predicting outputs of sequence models on new data</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_S_base">DeepTCR_S_base</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_S_base.AUC_Curve">AUC_Curve()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_S_base.AUC_Curve--auc-curve-for-both-sequence-and-repertoiresample-classifiers">AUC Curve for both Sequence and Repertoire/Sample Classifiers</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_S_base.Representative_Sequences">Representative_Sequences()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_S_base.Representative_Sequences--identify-most-highly-predicted-sequences-for-each-class-and-corresponding-motifs">Identify most highly predicted sequences for each class and corresponding motifs.</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_S_base.Residue_Sensitivity_Logo">Residue_Sensitivity_Logo()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_S_base.Residue_Sensitivity_Logo--create-residue-sensitivity-logos">Create Residue Sensitivity Logos</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_S_base.SRCC">SRCC()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_S_base.SRCC--spearmans-rank-correlation-coefficient-plot">Spearman's Rank Correlation Coefficient Plot</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_SS">DeepTCR_SS</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_SS.Get_Train_Valid_Test">Get_Train_Valid_Test()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_SS.Get_Train_Valid_Test--trainvalidtest-splits">Train/Valid/Test Splits.</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_SS.K_Fold_CrossVal">K_Fold_CrossVal()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_SS.K_Fold_CrossVal--k_fold-cross-validation-for-single-sequence-classifier">K_Fold Cross-Validation for Single-Sequence Classifier</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_SS.Monte_Carlo_CrossVal">Monte_Carlo_CrossVal()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_SS.Monte_Carlo_CrossVal--monte-carlo-cross-validation-for-single-sequence-classifier">Monte Carlo Cross-Validation for Single-Sequence Classifier</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_SS.Train">Train()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_SS.Train--train-single-sequence-classifier">Train Single-Sequence Classifier</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_U">DeepTCR_U</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_U.KNN_Repertoire_Classifier">KNN_Repertoire_Classifier()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_U.KNN_Repertoire_Classifier--k-nearest-neighbor-repertoire-classifier">K-Nearest Neighbor Repertoire Classifier</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_U.KNN_Sequence_Classifier">KNN_Sequence_Classifier()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_U.KNN_Sequence_Classifier--k-nearest-neighbor-sequence-classifier">K-Nearest Neighbor Sequence Classifier</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_U.Train_VAE">Train_VAE()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_U.Train_VAE--train-variational-autoencoder-vae">Train Variational Autoencoder (VAE)</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF">DeepTCR_WF</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.Get_Train_Valid_Test">Get_Train_Valid_Test()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.Get_Train_Valid_Test--trainvalidtest-splits">Train/Valid/Test Splits.</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.K_Fold_CrossVal">K_Fold_CrossVal()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.K_Fold_CrossVal--k_fold-cross-validation-for-whole-sample-classifier">K_Fold Cross-Validation for Whole Sample Classifier</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.Monte_Carlo_CrossVal">Monte_Carlo_CrossVal()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.Monte_Carlo_CrossVal--monte-carlo-cross-validation-for-whole-sample-classifier">Monte Carlo Cross-Validation for Whole Sample Classifier</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.Sample_Inference">Sample_Inference()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.Sample_Inference--predicting-outputs-of-samplerepertoire-model-on-new-data">Predicting outputs of sample/repertoire model on new data</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.Train">Train()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.DeepTCR_WF.Train--train-whole-sample-classifier">Train Whole-Sample Classifier</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#DeepTCR.DeepTCR.feature_analytics_class">feature_analytics_class</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.feature_analytics_class.Cluster">Cluster()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.feature_analytics_class.Cluster--clustering-sequences-by-latent-features">Clustering Sequences by Latent Features</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.feature_analytics_class.Motif_Identification">Motif_Identification()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.feature_analytics_class.Motif_Identification--motif-identification-supervised-classifiers">Motif Identification Supervised Classifiers</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.feature_analytics_class.Sample_Features">Sample_Features()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.feature_analytics_class.Sample_Features--sample-level-feature-values">Sample-Level Feature Values</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.feature_analytics_class.Structural_Diversity">Structural_Diversity()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.feature_analytics_class.Structural_Diversity--structural-diversity-measurements">Structural Diversity Measurements</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class">vis_class</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.HeatMap_Samples">HeatMap_Samples()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.HeatMap_Samples--heatmap-of-samples">HeatMap of Samples</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.HeatMap_Sequences">HeatMap_Sequences()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.HeatMap_Sequences--heatmap-of-sequences">HeatMap of Sequences</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.Repertoire_Dendrogram">Repertoire_Dendrogram()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.Repertoire_Dendrogram--repertoire-dendrogram">Repertoire Dendrogram</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.UMAP_Plot">UMAP_Plot()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.UMAP_Plot--umap-visualization-of-tcr-sequences">UMAP visualization of TCR Sequences</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.UMAP_Plot_Samples">UMAP_Plot_Samples()</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#DeepTCR.DeepTCR.vis_class.UMAP_Plot_Samples--umap-visualization-of-tcr-samples">UMAP visualization of TCR Samples</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../releasehx/">Release History</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">DeepTCR</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>API reference</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <div class="doc doc-object doc-module">



<h2 id="DeepTCR.DeepTCR" class="doc doc-heading">
        <code>DeepTCR.DeepTCR</code>



</h2>

    <div class="doc doc-contents first">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="DeepTCR.DeepTCR.DeepTCR_base" class="doc doc-heading">
        <code>DeepTCR_base</code>



</h3>

    <div class="doc doc-contents ">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_base.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tf_verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_base.__init__--initialize-training-object">Initialize Training Object.</h5>
<p>Initializes object and sets initial parameters.</p>
<p>All DeepTCR algorithms begin with initializing a training object. This object will contain all methods, data, and results during the training process. One can extract learned features, per-sequence predictions, among other outputs from DeepTCR and use those in their own analyses as well.</p>
<p>This method is included in the three main DeepTCR objects:</p>
<ul>
<li>DeepTCR_U (unsupervised)</li>
<li>DeepTCR_SS (supervised sequence classifier/regressor)</li>
<li>DeepTCR_WF (supervised repertoire classifier/regressor)</li>
</ul>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>Name</strong> (<code>str</code>) – Name of the object. This name will be used to create folders with results as well as a folder with parameters and specifications for any models built/trained.</p></li>
            <li><p><strong>max_length</strong> (<code>int</code>) – maximum length of CDR3 sequence.</p></li>
            <li><p><strong>device</strong> (<code>int</code>) – In the case user is using tensorflow-gpu, one can specify the particular device to build the graphs on. This selects which GPU the user wants to put the graph and train on.</p></li>
            <li><p><strong>tf_verbosity</strong> (<code>str</code>) – determines how much tensorflow log output to display while training.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_base.Get_Data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Get_Data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">Load_Prev_Data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type_of_data_cut</span><span class="o">=</span><span class="s1">&#39;Fraction_Response&#39;</span><span class="p">,</span> <span class="n">data_cut</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">aa_column_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aa_column_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">aggregate_by_aa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">v_alpha_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_alpha_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_beta_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_beta_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_beta_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hla</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_hla_supertype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keep_non_supertype_alleles</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_base.Get_Data--get-data-for-deeptcr">Get Data for DeepTCR</h5>
<p>Parse Data into appropriate inputs for neural network from directories where data is stored.</p>
<p>This method can be used when your data is stored in directories and you want to load it from directoreis into DeepTCR. This method takes care of all pre-processing of the data including:</p>
<ul>
<li>Combining all CDR3 sequences with the same nucleotide sequence (optional).</li>
<li>Removing any sequences with non-IUPAC characters.</li>
<li>Removing any sequences that are longer than the max_length set when initializing the training object.</li>
<li>Determining how much of the data per file to use (type_of_data_cut)</li>
<li>Whether to use HLA/HLA-supertypes during training.</li>
</ul>
<p>This method is included in the three main DeepTCR objects:</p>
<ul>
<li>DeepTCR_U (unsupervised)</li>
<li>DeepTCR_SS (supervised sequence classifier/regressor)</li>
<li>DeepTCR_WF (supervised repertoire classifier/regressor)</li>
</ul>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>directory</strong> (<code>str</code>) – Path to directory with folders with tsv/csv files are present for analysis. Folders names become           labels for files within them. If the directory contains the TCRSeq files not organized into classes/labels,             DeepTCR will load all files within that directory.</p></li>
            <li><p><strong>Load_Prev_Data</strong> (<code>bool</code>) – Loads Previous Data. This allows the user to run the method once, and then set this parameter to True to reload the data from a local pickle file.</p></li>
            <li><p><strong>classes</strong> (<code>list</code>) – Optional selection of input of which sub-directories to use for analysis.</p></li>
            <li><p><strong>type_of_data_cut</strong> (<code>str</code>) – Method by which one wants to sample from the TCRSeq File.</p>
<h6 id="DeepTCR.DeepTCR.DeepTCR_base.Get_Data--_1"></h6>
<p>Options are:</p>
<ul>
<li>
<p>Fraction_Response: A fraction (0 - 1) that samples the top fraction of the file by reads. For example, if one wants to sample the top 25% of reads, one would use this threshold with a data_cut = 0.25. The idea of this sampling is akin to sampling a fraction of cells from the file.</p>
</li>
<li>
<p>Frequency_Cut: If one wants to select clones above a given frequency threshold, one would use this threshold. For example, if one wanted to only use clones about 1%, one would enter a data_cut value of 0.01.</p>
</li>
<li>
<p>Num_Seq: If one wants to take the top N number of clones, one would use this threshold. For example, if one wanted to select the top 10 amino acid clones from each file, they would enter a data_cut value of 10.</p>
</li>
<li>
<p>Read_Cut: If one wants to take amino acid clones with at least a certain number of reads, one would use this threshold. For example, if one wanted to only use clones with at least 10 reads,they would enter a data_cut value of 10.</p>
</li>
<li>
<p>Read_Sum: IF one wants to take a given number of reads from each file, one would use this threshold. For example, if one wants to use the sequences comprising the top 100 reads of hte file, they would enter a data_cut value of 100.</p>
</li>
</ul></li>
            <li><p><strong>data_cut</strong> (<code>float or int</code>) – Value  associated with type_of_data_cut parameter.</p></li>
            <li><p><strong>n_jobs</strong> (<code>int</code>) – Number of processes to use for parallelized operations.</p></li>
            <li><p><strong>aa_column_alpha</strong> (<code>int</code>) – Column where alpha chain amino acid data is stored. (0-indexed).</p></li>
            <li><p><strong>aa_column_beta</strong> (<code>int</code>) – Column where beta chain amino acid data is stored.(0-indexed)</p></li>
            <li><p><strong>count_column</strong> (<code>int</code>) – Column where counts are stored.</p></li>
            <li><p><strong>sep</strong> (<code>str</code>) – Type of delimiter used in file with TCRSeq data.</p></li>
            <li><p><strong>aggregate_by_aa</strong> (<code>bool</code>) – Choose to aggregate sequences by unique amino-acid. Defaults to True. If set to False, will allow duplicates of the same amino acid sequence given it comes from different nucleotide clones.</p></li>
            <li><p><strong>v_alpha_column</strong> (<code>int</code>) – Column where v_alpha gene information is stored.</p></li>
            <li><p><strong>j_alpha_column</strong> (<code>int</code>) – Column where j_alpha gene information is stored.</p></li>
            <li><p><strong>v_beta_column</strong> (<code>int</code>) – Column where v_beta gene information is stored.</p></li>
            <li><p><strong>d_beta_column</strong> (<code>int</code>) – Column where d_beta gene information is stored.</p></li>
            <li><p><strong>j_beta_column</strong> (<code>int</code>) – Column where j_beta gene information is stored.</p></li>
            <li><p><strong>p</strong> (<code>multiprocessing pool object</code>) – For parellelized operations, one can pass a multiprocessing pool object to this method.</p></li>
            <li><p><strong>hla</strong> (<code>str</code>) – In order to use HLA information as part of the TCR-seq representation, one can provide a csv file where the first column is the file name and the remaining columns hold HLA alleles for each file. By including HLA information for each repertoire being analyzed, one is able to find a representation of TCR-Seq that is more meaningful across repertoires with different HLA backgrounds.</p></li>
            <li><p><strong>use_hla_supertype</strong> (<code>bool</code>) – Given the diversity of the HLA-loci, training with a full allele may cause over-fitting. And while individuals may have different HLA alleles, these different allelees may bind peptide in a functionality similar way. This idea of supertypes of HLA is a method by which assignments of HLA genes can be aggregated to 6 HLA-A and 6 HLA-B supertypes. In roder to convert input of HLA-allele genes to supertypes, a more biologically functional representation, one can se this parameter to True and if the alleles provided are of one of 945 alleles found in the reference below, it will be assigned to a known supertype.</p>
<ul>
<li>
<p>For this method to work, alleles must be provided in the following format: A0101 where the first letter of the designation is the HLA loci (A or B) and then the 4 digit gene designation. HLA supertypes only exist for HLA-A and HLA-B. All other alleles will be dropped from the analysis.</p>
</li>
<li>
<p>Sidney, J., Peters, B., Frahm, N., Brander, C., &amp; Sette, A. (2008). HLA class I supertypes: a revised and updated classification. BMC immunology, 9(1), 1.</p>
</li>
</ul></li>
            <li><p><strong>keep_non_supertype_alleles</strong> (<code>bool</code>) – If assigning supertypes to HLA alleles, one can choose to keep HLA-alleles that do not have a known supertype (i.e. HLA-C alleles or certain HLA-A or HLA-B alleles) or discard them for the analysis. In order to keep these alleles, one should set this parameter to True. Default is False and non HLA-A or B alleles will be discarded.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`variables into training object</p>
<ul>
<li>self.alpha_sequences (ndarray)` – array with alpha sequences (if provided)</li>
<li>self.beta_sequences (ndarray): array with beta sequences (if provided)</li>
<li>self.class_id (ndarray): array with sequence class labels</li>
<li>self.sample_id (ndarray): array with sequence file labels</li>
<li>self.freq (ndarray): array with sequence frequencies from samples</li>
<li>self.counts (ndarray): array with sequence counts from samples</li>
<li>self.(v/d/j)_(alpha/beta) (ndarray): array with sequence (v/d/j)-(alpha/beta) usage</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_base.Load_Data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Load_Data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">beta_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">class_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hla</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_hla_supertype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keep_non_supertype_alleles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_base.Load_Data--load-data-programatically-into-deeptcr">Load Data programatically into DeepTCR.</h5>
<p>DeepTCR allows direct user input of sequence data for DeepTCR analysis. By using this method,
a user can load numpy arrays with relevant TCRSeq data for analysis.</p>
<p>Tip: One can load data with the Get_Data command from directories and then reload it into another DeepTCR object with the Load_Data command. This can be useful, for example, if you have different labels you want to train to, and you need to change the label programatically between training each model. In this case, one can load the data first with the Get_Data method and then assign the labels pythonically before feeding them into the DeepTCR object with the Load_Data method.</p>
<p>Of note, this method DOES NOT combine sequences with the same amino acid sequence. Therefore, if one wants this, one should first do it programatically before feeding the data into DeepTCR with this method.</p>
<p>Another special use case of this method would be for any type of regression task (sequence or repertoire models). In the case that a per-sequence value is fed into DeepTCR (with Y), this value either becomes the per-sequence regression value or the average of all Y over a sample becomes the per-sample regression value. This is another case where one might want to load data with the Get_Data method and then reload it into DeepTCR with regression values.</p>
<p>This method is included in the three main DeepTCR objects:</p>
<ul>
<li>DeepTCR_U (unsupervised)</li>
<li>DeepTCR_SS (supervised sequence classifier/regressor)</li>
<li>DeepTCR_WF (supervised repertoire classifier/regressor)</li>
</ul>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>alpha_sequences</strong> (<code>ndarray of strings</code>) – A 1d array with the sequences for inference for the alpha chain.</p></li>
            <li><p><strong>beta_sequences</strong> (<code>ndarray of strings</code>) – A 1d array with the sequences for inference for the beta chain.</p></li>
            <li><p><strong>v_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the v-beta genes for inference.</p></li>
            <li><p><strong>d_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the d-beta genes for inference.</p></li>
            <li><p><strong>j_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the j-beta genes for inference.</p></li>
            <li><p><strong>v_alpha</strong> (<code>ndarray of strings</code>) – A 1d array with the v-alpha genes for inference.</p></li>
            <li><p><strong>j_alpha</strong> (<code>ndarray of strings</code>) – A 1d array with the j-alpha genes for inference.</p></li>
            <li><p><strong>class_labels</strong> (<code>ndarray of strings</code>) – A 1d array with class labels for the sequence (i.e. antigen-specificities)</p></li>
            <li><p><strong>sample_labels</strong> (<code>ndarray of strings</code>) – A 1d array with sample labels for the sequence. (i.e. when loading data from different samples)</p></li>
            <li><p><strong>counts</strong> (<code>ndarray of ints</code>) – A 1d array with the counts for each sequence, in the case they come from samples.</p></li>
            <li><p><strong>freq</strong> (<code>ndarray of float values</code>) – A 1d array with the frequencies for each sequence, in the case they come from samples.</p></li>
            <li><p><strong>Y</strong> (<code>ndarray of float values</code>) – In the case one wants to regress TCR sequences or repertoires against a numerical label, one can provide these numerical values for this input. For the TCR sequence regressor, each sequence will be regressed to the value denoted for each sequence. For the TCR repertoire regressor, the average of all instance level values will be used to regress the sample. Therefore, if there is one sample level value for regression, one would just repeat that same value for all the instances/sequences of the sample.</p></li>
            <li><p><strong>hla</strong> (<code>ndarray of tuples/arrays</code>) – To input the hla context for each sequence fed into DeepTCR, this will need to formatted as an ndarray that is (N,) for each sequence where each entry is a tuple or array of strings referring to the alleles seen for that sequence. ('A<em>01:01', 'A</em>11:01', 'B<em>35:01', 'B</em>35:02', 'C*04:01')</p></li>
            <li><p><strong>use_hla_supertype</strong> (<code>bool</code>) – Given the diversity of the HLA-loci, training with a full allele may cause over-fitting. And while individuals may have different HLA alleles, these different allelees may bind peptide in a functionality similar way. This idea of supertypes of HLA is a method by which assignments of HLA genes can be aggregated to 6 HLA-A and 6 HLA-B supertypes. In roder to convert input of HLA-allele genes to supertypes, a more biologically functional representation, one can se this parameter to True and if the alleles provided are of one of 945 alleles found in the reference below, it will be assigned to a known supertype.</p>
<ul>
<li>
<p>For this method to work, alleles must be provided in the following format: A0101 where the first letter of the designation is the HLA loci (A or B) and then the 4 digit gene designation. HLA supertypes only exist for HLA-A and HLA-B. All other alleles will be dropped from the analysis.</p>
</li>
<li>
<p>Sidney, J., Peters, B., Frahm, N., Brander, C., &amp; Sette, A. (2008). HLA class I supertypes: a revised and updated classification. BMC immunology, 9(1), 1.</p>
</li>
</ul></li>
            <li><p><strong>keep_non_supertype_alleles</strong> (<code>bool</code>) – If assigning supertypes to HLA alleles, one can choose to keep HLA-alleles that do not have a known supertype (i.e. HLA-C alleles or certain HLA-A or HLA-B alleles) or discard them for the analysis. In order to keep these alleles, one should set this parameter to True. Default is False and non HLA-A or B alleles will be discarded.</p></li>
            <li><p><strong>p</strong> (<code>multiprocessing pool object</code>) – a pre-formed pool object can be passed to method for multiprocessing tasks.</p></li>
            <li><p><strong>w</strong> (<code>ndarray</code>) – optional set of weights for training of autoencoder</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`variables into training object</p>
<ul>
<li>self.alpha_sequences (ndarray)` – array with alpha sequences (if provided)</li>
<li>self.beta_sequences (ndarray): array with beta sequences (if provided)</li>
<li>self.label_id (ndarray): array with sequence class labels</li>
<li>self.file_id (ndarray): array with sequence file labels</li>
<li>self.freq (ndarray): array with sequence frequencies from samples</li>
<li>self.counts (ndarray): array with sequence counts from samples</li>
<li>self.(v/d/j)_(alpha/beta) (ndarray):array with sequence (v/d/j)-(alpha/beta) usage</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>      <hr />

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_base.Sequence_Inference" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Sequence_Inference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">beta_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hla</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_base.Sequence_Inference--predicting-outputs-of-sequence-models-on-new-data">Predicting outputs of sequence models on new data</h5>
<p>This method allows a user to take a pre-trained autoencoder/sequence classifier and generate outputs from the model on new data. For the autoencoder, this returns the features from the latent space. For the sequence classifier, it is the probability of belonging to each class.</p>
<p>In the case that multiple models have been trained via MC or K-fold Cross-Validation strategy for the sequence classifier, this method can use some or all trained models in an ensemble fashion to provide the average prediction per sequence as well as the distribution of predictions from all trained models.</p>
<p>This method is included in the two sequence DeepTCR objects:</p>
<ul>
<li>DeepTCR_U (unsupervised)</li>
<li>DeepTCR_SS (supervised sequence classifier/regressor)</li>
</ul>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>alpha_sequences</strong> (<code>ndarray of strings</code>) – A 1d array with the sequences for inference for the alpha chain.</p></li>
            <li><p><strong>beta_sequences</strong> (<code>ndarray of strings</code>) – A 1d array with the sequences for inference for the beta chain.</p></li>
            <li><p><strong>v_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the v-beta genes for inference.</p></li>
            <li><p><strong>d_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the d-beta genes for inference.</p></li>
            <li><p><strong>j_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the j-beta genes for inference.</p></li>
            <li><p><strong>v_alpha</strong> (<code>ndarray of strings</code>) – A 1d array with the v-alpha genes for inference.</p></li>
            <li><p><strong>j_alpha</strong> (<code>ndarray of strings</code>) – A 1d array with the j-alpha genes for inference.</p></li>
            <li><p><strong>hla</strong> (<code>ndarray of tuples/arrays</code>) – To input the hla context for each sequence fed into DeepTCR, this will need to formatted as an ndarray that is (N,) for each sequence where each entry is a tuple/array of strings referring to the alleles seen for that sequence. ('A<em>01:01', 'A</em>11:01', 'B<em>35:01', 'B</em>35:02', 'C*04:01')</p>
<ul>
<li>If the model used for inference was trained to use HLA-supertypes, one should still enter the HLA in the format it was provided to the original model (i.e. A0101). This mehthod will then convert those HLA alleles into the appropriaet supertype designation. The HLA alleles DO NOT need to be provided to this method in the supertype designation.</li>
</ul></li>
            <li><p><strong>p</strong> (<code>multiprocessing pool object</code>) – a pre-formed pool object can be passed to method for multiprocessing tasks.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Batch size for inference.</p></li>
            <li><p><strong>models</strong> (<code>list</code>) – In the case of the supervised sequence classifier, if several models were trained (via MC or Kfold crossvals), one can specify which ones to use for inference. Otherwise, thie method uses all trained models found in Name/models/ in an ensemble fashion. The method will output of the average of all models as well as the distribution of outputs for the user.</p></li>
            <li><p><strong>return_dist</strong> (<code>bool</code>) – If the user wants to also return teh distribution of sequence predicionts over all models use dfor inference, one should set this value to True.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`features, features_dist</p>
<ul>
<li>
<p>features (array), shape = [N, latent_dim]` – An array that contains n x latent_dim containing features for all sequences. For the VAE, this represents the features from the latent space. For the sequence classifier, this represents the probabilities for every class or the regressed value from the sequence regressor. In the case of multiple models being used for inference in ensemble, this becomes the average prediction over all models.</p>
</li>
<li>
<p>features_dist (array), shape = [n_models,N,latent_dim]: An array that contains the output of all models separately for each input sequence. This output is useful if using multiple models in ensemble to predict on a new sequence. This output describes the distribution of the predictions over all models.</p>
</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="DeepTCR.DeepTCR.DeepTCR_S_base" class="doc doc-heading">
        <code>DeepTCR_S_base</code>



</h3>

    <div class="doc doc-contents ">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_S_base.AUC_Curve" class="doc doc-heading">
<code class="highlight language-python"><span class="n">AUC_Curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;AUC.tif&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">diag_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xtick_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ytick_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_font_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">color_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_S_base.AUC_Curve--auc-curve-for-both-sequence-and-repertoiresample-classifiers">AUC Curve for both Sequence and Repertoire/Sample Classifiers</h5>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>by</strong> (<code>str</code>) – To show AUC curve for only one class, set this parameter to the name of the class label one wants to plot.</p></li>
            <li><p><strong>filename</strong> (<code>str</code>) – Filename to save tif file of AUC curve.</p></li>
            <li><p><strong>title</strong> (<code>str</code>) – Optional Title to put on ROC Curve.</p></li>
            <li><p><strong>title_font</strong> (<code>int</code>) – Optional font size for title</p></li>
            <li><p><strong>plot</strong> (<code>bool</code>) – To suppress plotting and just save the data/figure, set to False.</p></li>
            <li><p><strong>diag_line</strong> (<code>bool</code>) – To plot the line/diagonal of y=x defining no predictive power, set to True. To remove from plot, set to False.</p></li>
            <li><p><strong>xtick_size</strong> (<code>float</code>) – Size of xticks</p></li>
            <li><p><strong>ytick_size</strong> (<code>float</code>) – Size of yticks</p></li>
            <li><p><strong>xlabel_size</strong> (<code>float</code>) – Size of xlabel</p></li>
            <li><p><strong>ylabel_size</strong> (<code>float</code>) – Size of ylabel</p></li>
            <li><p><strong>legend_font_size</strong> (<code>float</code>) – Size of legend</p></li>
            <li><p><strong>frameon</strong> (<code>bool</code>) – Whether to show frame around legend.</p></li>
            <li><p><strong>figsize</strong> (<code>tuple</code>) – To change the default size of the figure, set this to size of figure (i.e. - (10,10) )</p></li>
            <li><p><strong>set</strong> (<code>str</code>) – Which partition of the data to look at performance of model. Options are train/valid/test.</p></li>
            <li><p><strong>color_dict</strong> (<code>dict</code>) – An optional dictionary that maps classes to colors in the case user wants to define colors of lines on plot.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`AUC Data</p>
<ul>
<li>self.AUC_DF (Pandas Dataframe)` – AUC scores are returned for each class.</li>
</ul>
<p>In addition to plotting the ROC Curve, the AUC's are saved to a csv file in the results directory called 'AUC.csv'</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_S_base.Representative_Sequences" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Representative_Sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top_seq</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">motif_seq</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">make_seq_logos</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_scheme</span><span class="o">=</span><span class="s1">&#39;weblogo_protein&#39;</span><span class="p">,</span> <span class="n">logo_file_format</span><span class="o">=</span><span class="s1">&#39;.eps&#39;</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_S_base.Representative_Sequences--identify-most-highly-predicted-sequences-for-each-class-and-corresponding-motifs">Identify most highly predicted sequences for each class and corresponding motifs.</h5>
<p>This method allows the user to query which sequences were most predicted to belong to a given class along with the motifs that were learned for these representative sequences. Of note, this method only reports sequences that were in the test set so as not to return highly predicted sequences that were over-fit in the training set. To obtain the highest predicted sequences in all the data, run a K-fold cross-validation or Monte-Carlo cross-validation before running this method. In this way, the predicted probability will have been assigned to a sequence only when it was in the independent test set.</p>
<p>In the case of a regression task, the representative sequences for the 'high' and 'low' values for the regression model are returned in the Rep_Seq Dict.</p>
<p>This method will also determine motifs the network has learned that are highly associated with the label through multi-nomial linear regression and creates seq logos and fasta files in the results folder. Within a folder for a given class, the motifs are sorted by their linear coefficient. The coefficient is in the file name (i.e. 0_0.125_feature_2.eps reflects the the 0th highest feature with a coefficient of 0.125.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>top_seq</strong> (<code>int</code>) – The number of top sequences to show for each class.</p></li>
            <li><p><strong>motif_seq</strong> (<code>int</code>) – The number of sequences to use to generate each motif. The more sequences, the possibly more noisy the seq_logo will be.</p></li>
            <li><p><strong>make_seq_logos</strong> (<code>bool</code>) – In order to make seq logos for visualization of enriched motifs, set this to True. Whether this is set to True or not, the fast files that define enriched motifs will still be saved.</p></li>
            <li><p><strong>color_scheme</strong> (<code>str</code>) – color scheme to use for LogoMaker.</p></li>
            <li><p><strong>options</strong> (<code>are</code>) – - weblogo_protein
- skylign_protein
- dmslogo_charge
- dmslogo_funcgroup
- hydrophobicity
- chemistry
- charge
- NajafabadiEtAl2017</p></li>
            <li><p><strong>logo_file_format</strong> (<code>str</code>) – The type of image file one wants to save the seqlogo as. Default is vector-based format (.eps)</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Outputs</p>
<ul>
<li>
<p>self.Rep_Seq (dictionary of dataframes)` – This dictionary of dataframes holds for each class the top sequences and their respective probabiltiies for all classes. These dataframes can also be found in the results folder under Rep_Sequences.</p>
</li>
<li>
<p>self.Rep_Seq_Features_(alpha/beta) (dataframe):
This dataframe holds information for which features were associated by a multinomial linear model to the predicted probabilities of the neural network. The values in this dataframe are the linear model coefficients. This allows one to see which features were associated with the output of the trained neural network. These are also the same values that are on the motif seqlogo files in the results folder.</p>
</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>      <p>Furthermore, the motifs are written in the results directory underneath the Motifs folder. To find the beta motifs for a given class, look under Motifs/beta/class_name/. These fasta/logo files are labeled by the linear coefficient of that given feature for that given class followed by the number name of the feature. These fasta files can then be visualized via weblogos at the following site: "https://weblogo.berkeley.edu/logo.cgi" or are present in the folder for direct visualization.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_S_base.Residue_Sensitivity_Logo" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Residue_Sensitivity_Logo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">beta_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hla</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">low_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">medium_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">high_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">class_sel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">Load_Prev_Data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm_to_seq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_S_base.Residue_Sensitivity_Logo--create-residue-sensitivity-logos">Create Residue Sensitivity Logos</h5>
<p>This method allows the user to create Residue Sensitivity Logos where a set of provided sequences is perturbed to assess for position of the CDR3 sequence that if altered, would change the predicted specificity or affinity of the sequence (depending on whether training classification or regression task).</p>
<p>Residue Sensitivity Logos can be created from any supervised model (including sequence and repertoire classifiers). Following the training of one of these models, one can feed into this method an cdr3 sequence defined by all/any of alpha/beta cdr3 sequence, V/D/J gene usage, and HLA context within which the TCR was seen.</p>
<p>The output is a logo created by LogoMaker where the size of the character denotes how sensitive this position is to perturbation and color denotes the consequences of changes at this site. As default, red coloration means changes at this site would generally decrease the predicted value and blue coloration means changes at this site would increase the predicted value.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>alpha_sequences</strong> (<code>ndarray of strings</code>) – A 1d array with the sequences for inference for the alpha chain.</p></li>
            <li><p><strong>beta_sequences</strong> (<code>ndarray of strings</code>) – A 1d array with the sequences for inference for the beta chain.</p></li>
            <li><p><strong>v_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the v-beta genes for inference.</p></li>
            <li><p><strong>d_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the d-beta genes for inference.</p></li>
            <li><p><strong>j_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the j-beta genes for inference.</p></li>
            <li><p><strong>v_alpha</strong> (<code>ndarray of strings</code>) – A 1d array with the v-alpha genes for inference.</p></li>
            <li><p><strong>j_alpha</strong> (<code>ndarray of strings</code>) – A 1d array with the j-alpha genes for inference.</p></li>
            <li><p><strong>hla</strong> (<code>ndarray of tuples/arrays</code>) – To input the hla context for each sequence fed into DeepTCR, this will need to formatted as an ndarray that is (N,) for each sequence where each entry is a tuple/array of strings referring to the alleles seen for that sequence. ('A<em>01:01', 'A</em>11:01', 'B<em>35:01', 'B</em>35:02', 'C*04:01')</p></li>
            <li><p><strong>p</strong> (<code>multiprocessing pool object</code>) – a pre-formed pool object can be passed to method for multiprocessing tasks.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Batch size for inference.</p></li>
            <li><p><strong>models</strong> (<code>list</code>) – In the case of the supervised sequence classifier, if several models were trained (via MC or Kfold crossvals), one can specify which ones to use for inference. Otherwise, thie method uses all trained models found in Name/models/ in an ensemble fashion. The method will output of the average of all models as well as the distribution of outputs for the user.</p></li>
            <li><p><strong>figsize</strong> (<code>tuple</code>) – This specifies the dimensions of the logo.</p></li>
            <li><p><strong>low_color</strong> (<code>str</code>) – The color to use when changes at this site would largely result in decreased prediction values.</p></li>
            <li><p><strong>medium_color</strong> (<code>str</code>) – The color to use when changes at this site would result in either decreased or inreased prediction values.</p></li>
            <li><p><strong>high_color</strong> (<code>str</code>) – The color to use when changes at this site would result in increased prediction values.</p></li>
            <li><p><strong>font_name</strong> (<code>str</code>) – The font to use for LogoMaker.</p></li>
            <li><p><strong>class_sel</strong> (<code>str</code>) – In the case of a model being trained in a multi-class fashion, one must select which class to make the logo for.</p></li>
            <li><p><strong>cmap</strong> (<code>matplotlib cmap</code>) – One can alsp provide custom cmap for logomaker that will be used to denote changes at sites that result in increased of decreased prediction values.</p></li>
            <li><p><strong>min_size</strong> (<code>float (0.0 - 1.0</code>) – </p></li>
            <li><p><strong>edgecolor</strong> (<code>str</code>) – The color of the edge of the characters of the logo.</p></li>
            <li><p><strong>edgewidth</strong> (<code>float</code>) – The thickness of the edge of the characters.</p></li>
            <li><p><strong>background_color</strong> (<code>str</code>) – The background color of the logo.</p></li>
            <li><p><strong>norm_to_seq</strong> (<code>bool</code>) – When determining the color intensity of the logo, one can choose to normalize the value to just characters in that sequence (True) or one can choose to normalize to all characters in the sequences provdied (False).</p></li>
            <li><p><strong>Load_Prev_Data</strong> (<code>bool</code>) – Since the first part of the method runs a time-intensive step to get all the predictions for all perturbations at all residue sites, we've incorporated a paramter which can be set to True following running the method once in order to adjust the visual aspects of the plot. Therefore, one should run this method first setting this parameter to False (it's default setting) but then switch to True and run again with different visualization parameters (i.e. figsize, etc).</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`` – Residue Sensitivity Logo</p>
<ul>
<li>(fig,ax) - the matplotlib figure and axis/axes.</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_S_base.SRCC" class="doc doc-heading">
<code class="highlight language-python"><span class="n">SRCC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_S_base.SRCC--spearmans-rank-correlation-coefficient-plot">Spearman's Rank Correlation Coefficient Plot</h5>
<p>In the case one is doing a regression-based model for the sequence classiifer, one can plot the predicted vs actual labeled value with this method. The method returns a plot for the regression and a value of the correlation coefficient.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>s</strong> (<code>int</code>) – size of points for scatterplot</p></li>
            <li><p><strong>kde</strong> (<code>bool</code>) – To do a kernel density estimation per point and plot this as a color-scheme, set to True. Warning: this option will take longer to run.</p></li>
            <li><p><strong>title</strong> (<code>str</code>) – Title for the plot.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`SRCC Output</p>
<ul>
<li>
<p>corr (float)` – Spearman's Rank Correlation Coefficient</p>
</li>
<li>
<p>ax (matplotlib axis):
    axis on which plot is drawn</p>
</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="DeepTCR.DeepTCR.DeepTCR_SS" class="doc doc-heading">
        <code>DeepTCR_SS</code>



</h3>

    <div class="doc doc-contents ">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_SS.Get_Train_Valid_Test" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Get_Train_Valid_Test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">LOO</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_by_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">combine_train_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_SS.Get_Train_Valid_Test--trainvalidtest-splits">Train/Valid/Test Splits.</h5>
<p>Divide data for train, valid, test set. Training is used to train model parameters, validation is used to set early stopping, and test acts as blackbox independent test set.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>test_size</strong> (<code>float</code>) – Fraction of sample to be used for valid and test set.</p></li>
            <li><p><strong>LOO</strong> (<code>int</code>) – Number of sequences to leave-out in Leave-One-Out Cross-Validation. For example, when set to 20, 20 sequences will be left out for the validation set and 20 samples will be left out for the test set.</p></li>
            <li><p><strong>split_by_sample</strong> (<code>int</code>) – In the case one wants to train the single sequence classifer but not to mix the train/test sets with sequences from different samples, one can set this parameter to True to do the train/test splits by sample.</p></li>
            <li><p><strong>combine_train_valid</strong> (<code>bool</code>) – To combine the training and validation partitions into one which will be used for training and updating the model parameters, set this to True. This will also set the validation partition to the test partition. In other words, new train set becomes (original train + original valid) and then new valid = original test partition, new test = original test partition. Therefore, if setting this parameter to True, change one of the training parameters to set the stop training criterion (i.e. train_loss_min) to stop training based on the train set. If one does not chanage the stop training criterion, the decision of when to stop training will be based on the test data (which is considered a form of over-fitting).</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_SS.K_Fold_CrossVal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">K_Fold_CrossVal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_by_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">combine_train_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">seeds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">trainable_embedding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embedding_dim_aa</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">embedding_dim_genes</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">embedding_dim_hla</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">num_fc_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units_fc</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight_by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">class_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_only_seq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_gene</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_hla</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_of_net</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">graph_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drop_out_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">multisample_dropout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multisample_dropout_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">multisample_dropout_num_masks</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">epochs_min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">stop_criterion_window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">accuracy_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">train_loss_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hinge_loss_t</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">convergence</span><span class="o">=</span><span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">suppress_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">batch_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_SS.K_Fold_CrossVal--k_fold-cross-validation-for-single-sequence-classifier">K_Fold Cross-Validation for Single-Sequence Classifier</h5>
<p>If the number of sequences is small but training the single-sequence classifier, one
can use K_Fold Cross Validation to train on all but one before assessing
predictive performance.After this method is run, the AUC_Curve method can be run to
assess the overall performance.</p>
<p>The method also saves the per sequence predictions at the end of training in the variable self.predicted. These per sequenes predictions are only assessed when the sequences are in the test set.</p>
<p>The multisample parameters are used to implement Multi-Sample Dropout at the final layer of the model as described in "Multi-Sample Dropout for Accelerated Training and Better Generalization" https://arxiv.org/abs/1905.09788. This method has been shown to improve generalization of deep neural networks as well as inmprove convergence.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>folds</strong> (<code>int</code>) – Number of Folds</p></li>
            <li><p><strong>split_by_sample</strong> (<code>int</code>) – In the case one wants to train the single sequence classifer but not to mix the train/test sets with sequences from different samples, one can set this parameter to True to do the train/test splits by sample.</p></li>
            <li><p><strong>combine_train_valid</strong> (<code>bool</code>) – To combine the training and validation partitions into one which will be used for training and updating the model parameters, set this to True. This will also set the validation partition to the test partition. In other words, new train set becomes (original train + original valid) and then new valid = original test partition, new test = original test partition. Therefore, if setting this parameter to True, change one of the training parameters to set the stop training criterion (i.e. train_loss_min) to stop training based on the train set. If one does not chanage the stop training criterion, the decision of when to stop training will be based on the test data (which is considered a form of over-fitting).</p></li>
            <li><p><strong>seeds</strong> (<code>nd.array</code>) – In order to set a deterministic train/test split over the K-Fold Simulations, one can provide an array of seeds for each K-fold simulation. This will result in the same train/test split over the N Fold simulations. This parameter, if provided, should have the same size of the value of folds.</p></li>
            <li><p><strong>kernel</strong> (<code>int</code>) – Size of convolutional kernel for first layer of convolutions.</p></li>
            <li><p><strong>trainable_embedding</strong> (<code>bool</code>) – Toggle to control whether a trainable embedding layer is used or native one-hot representation for convolutional layers.</p></li>
            <li><p><strong>embedding_dim_aa</strong> (<code>int</code>) – Learned latent dimensionality of amino-acids.</p></li>
            <li><p><strong>embedding_dim_genes</strong> (<code>int</code>) – Learned latent dimensionality of VDJ genes</p></li>
            <li><p><strong>embedding_dim_hla</strong> (<code>int</code>) – Learned latent dimensionality of HLA</p></li>
            <li><p><strong>num_fc_layers</strong> (<code>int</code>) – Number of fully connected layers following convolutional layer.</p></li>
            <li><p><strong>units_fc</strong> (<code>int</code>) – Number of nodes per fully-connected layers following convolutional layer.</p></li>
            <li><p><strong>weight_by_class</strong> (<code>bool</code>) – Option to weight loss by the inverse of the class frequency. Useful for unbalanced classes.</p></li>
            <li><p><strong>class_weights</strong> (<code>dict</code>) – In order to specify custom weights for each class during training, one can provide a dictionary with these weights. i.e. {'A':1.0,'B':2.0'}</p></li>
            <li><p><strong>use_only_seq</strong> (<code>bool</code>) – To only use sequence feaures, set to True. This will turn off features learned from gene usage.</p></li>
            <li><p><strong>use_only_gene</strong> (<code>bool</code>) – To only use gene-usage features, set to True. This will turn off features from the sequences.</p></li>
            <li><p><strong>use_only_hla</strong> (<code>bool</code>) – To only use hla feaures, set to True.</p></li>
            <li><p><strong>size_of_net</strong> (<code>list or str</code>) – The convolutional layers of this network have 3 layers for which the use can modify the number of neurons per layer. The user can either specify the size of the network with the following options:</p>
<ul>
<li>small == [12,32,64] neurons for the 3 respective layers</li>
<li>medium == [32,64,128] neurons for the 3 respective layers</li>
<li>large == [64,128,256] neurons for the 3 respective layers</li>
<li>custom, where the user supplies a list with the number of nuerons for the respective layers
    i.e. [3,3,3] would have 3 neurons for all 3 layers.
    One can also adjust the number of layers for the convolutional stack by changing the length of
    this list. [3,3,3] = 3 layers, [3,3,3,3] = 4 layers.</li>
</ul></li>
            <li><p><strong>graph_seed</strong> (<code>int</code>) – For deterministic initialization of weights of the graph, set this to value of choice.</p></li>
            <li><p><strong>drop_out_rate</strong> (<code>float</code>) – drop out rate for fully connected layers</p></li>
            <li><p><strong>multisample_dropout</strong> (<code>bool</code>) – Set this parameter to True to implement this method.</p></li>
            <li><p><strong>multisample_dropout_rate</strong> (<code>float</code>) – The dropout rate for this multi-sample dropout layer.</p></li>
            <li><p><strong>multisample_dropout_num_masks</strong> (<code>int</code>) – The number of masks to sample from for the Multi-Sample Dropout layer.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Size of batch to be used for each training iteration of the net.</p></li>
            <li><p><strong>epochs_min</strong> (<code>int</code>) – Minimum number of epochs for training neural network.</p></li>
            <li><p><strong>stop_criterion</strong> (<code>float</code>) – Minimum percent decrease in determined interval (below) to continue training. Used as early stopping criterion.</p></li>
            <li><p><strong>stop_criterion_window</strong> (<code>int</code>) – The window of data to apply the stopping criterion.</p></li>
            <li><p><strong>accuracy_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training accuracy is achieved, at which point, training ceases.</p></li>
            <li><p><strong>train_loss_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training loss is achieved, at which point, training ceases.</p></li>
            <li><p><strong>hinge_loss_t</strong> (<code>float</code>) – The per sequence loss minimum at which the loss of that sequence is not used to penalize the model anymore. In other words, once a per sequence loss has hit this value, it gets set to 0.0.</p></li>
            <li><p><strong>convergence</strong> (<code>str</code>) – This parameter determines which loss to assess the convergence criteria on. Options are 'validation' or 'training'. This is useful in the case one wants to change the convergence criteria on the training data when the training and validation partitions have been combined and used to training the model.</p></li>
            <li><p><strong>learning_rate</strong> (<code>float</code>) – The learning rate for training the neural network. Making this value larger will increase the rate of convergence but can introduce instability into training. For most, altering this value will not be necessary.</p></li>
            <li><p><strong>suppress_output</strong> (<code>bool</code>) – To suppress command line output with training statisitcs, set to True.</p></li>
            <li><p><strong>batch_seed</strong> (<code>int</code>) – For deterministic batching during training, set this value to an integer of choice.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_SS.Monte_Carlo_CrossVal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Monte_Carlo_CrossVal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">LOO</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_by_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">combine_train_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">seeds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">trainable_embedding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embedding_dim_aa</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">embedding_dim_genes</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">embedding_dim_hla</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">num_fc_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units_fc</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight_by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">class_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_only_seq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_gene</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_hla</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_of_net</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">graph_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drop_out_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">multisample_dropout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multisample_dropout_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">multisample_dropout_num_masks</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">epochs_min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">stop_criterion_window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">accuracy_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">train_loss_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hinge_loss_t</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">convergence</span><span class="o">=</span><span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">suppress_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">batch_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_SS.Monte_Carlo_CrossVal--monte-carlo-cross-validation-for-single-sequence-classifier">Monte Carlo Cross-Validation for Single-Sequence Classifier</h5>
<p>If the number of sequences is small but training the single-sequence classifier, one can use Monte Carlo Cross Validation to train a number of iterations before assessing predictive performance.After this method is run, the AUC_Curve method can be run to assess the overall performance.</p>
<p>The method also saves the per sequence predictions at the end of training in the variable self.predicted. These per sequenes predictions are only assessed when the sequences are in the test set. Ideally, after running the classifier with multiple folds, each sequencce will have multiple predicttions that were collected when they were in the test set.</p>
<p>The multisample parameters are used to implement Multi-Sample Dropout at the final layer of the model as described in "Multi-Sample Dropout for Accelerated Training and Better Generalization" https://arxiv.org/abs/1905.09788. This method has been shown to improve generalization of deep neural networks as well as inmprove convergence.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>folds</strong> (<code>int</code>) – Number of iterations for Cross-Validation</p></li>
            <li><p><strong>test_size</strong> (<code>float</code>) – Fraction of sample to be used for valid and test set.</p></li>
            <li><p><strong>LOO</strong> (<code>int</code>) – Number of sequences to leave-out in Leave-One-Out Cross-Validation. For example, when set to 20, 20 sequences will be left out for the validation set and 20 samples will be left out for the test set.</p></li>
            <li><p><strong>split_by_sample</strong> (<code>int</code>) – In the case one wants to train the single sequence classifer but not to mix the train/test sets with sequences from different samples, one can set this parameter to True to do the train/test splits by sample.</p></li>
            <li><p><strong>combine_train_valid</strong> (<code>bool</code>) – To combine the training and validation partitions into one which will be used for training and updating the model parameters, set this to True. This will also set the validation partition to the test partition. In other words, new train set becomes (original train + original valid) and then new valid = original test partition, new test = original test partition. Therefore, if setting this parameter to True, change one of the training parameters to set the stop training criterion (i.e. train_loss_min) to stop training based on the train set. If one does not change the stop training criterion, the decision of when to stop training will be based on the test data (which is considered a form of over-fitting).</p></li>
            <li><p><strong>seeds</strong> (<code>nd.array</code>) – In order to set a deterministic train/test split over the Monte-Carlo Simulations, one can provide an array of seeds for each MC simulation. This will result in the same train/test split over the N MC simulations. This parameter, if provided, should have the same size of the value of folds.</p></li>
            <li><p><strong>kernel</strong> (<code>int</code>) – Size of convolutional kernel for first layer of convolutions.</p></li>
            <li><p><strong>trainable_embedding</strong> (<code>bool</code>) – Toggle to control whether a trainable embedding layer is used or native one-hot representation for convolutional layers.</p></li>
            <li><p><strong>embedding_dim_aa</strong> (<code>int</code>) – Learned latent dimensionality of amino-acids.</p></li>
            <li><p><strong>embedding_dim_genes</strong> (<code>int</code>) – Learned latent dimensionality of VDJ genes</p></li>
            <li><p><strong>embedding_dim_hla</strong> (<code>int</code>) – Learned latent dimensionality of HLA</p></li>
            <li><p><strong>num_fc_layers</strong> (<code>int</code>) – Number of fully connected layers following convolutional layer.</p></li>
            <li><p><strong>units_fc</strong> (<code>int</code>) – Number of nodes per fully-connected layers following convolutional layer.</p></li>
            <li><p><strong>weight_by_class</strong> (<code>bool</code>) – Option to weight loss by the inverse of the class frequency. Useful for unbalanced classes.</p></li>
            <li><p><strong>class_weights</strong> (<code>dict</code>) – In order to specify custom weights for each class during training, one can provide a dictionary with these weights. i.e. {'A':1.0,'B':2.0'}</p></li>
            <li><p><strong>use_only_seq</strong> (<code>bool</code>) – To only use sequence feaures, set to True. This will turn off features learned from gene usage.</p></li>
            <li><p><strong>use_only_gene</strong> (<code>bool</code>) – To only use gene-usage features, set to True. This will turn off features from the sequences.</p></li>
            <li><p><strong>use_only_hla</strong> (<code>bool</code>) – To only use hla feaures, set to True.</p></li>
            <li><p><strong>size_of_net</strong> (<code>list or str</code>) – The convolutional layers of this network have 3 layers for which the use can modify the number of neurons per layer. The user can either specify the size of the network with the following options:</p>
<ul>
<li>small == [12,32,64] neurons for the 3 respective layers</li>
<li>medium == [32,64,128] neurons for the 3 respective layers</li>
<li>large == [64,128,256] neurons for the 3 respective layers</li>
<li>custom, where the user supplies a list with the number of nuerons for the respective layers
    i.e. [3,3,3] would have 3 neurons for all 3 layers.
    One can also adjust the number of layers for the convolutional stack by changing the length of
    this list. [3,3,3] = 3 layers, [3,3,3,3] = 4 layers.</li>
</ul></li>
            <li><p><strong>graph_seed</strong> (<code>int</code>) – For deterministic initialization of weights of the graph, set this to value of choice.</p></li>
            <li><p><strong>drop_out_rate</strong> (<code>float</code>) – drop out rate for fully connected layers</p></li>
            <li><p><strong>multisample_dropout</strong> (<code>bool</code>) – Set this parameter to True to implement this method.</p></li>
            <li><p><strong>multisample_dropout_rate</strong> (<code>float</code>) – The dropout rate for this multi-sample dropout layer.</p></li>
            <li><p><strong>multisample_dropout_num_masks</strong> (<code>int</code>) – The number of masks to sample from for the Multi-Sample Dropout layer.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Size of batch to be used for each training iteration of the net.</p></li>
            <li><p><strong>epochs_min</strong> (<code>int</code>) – Minimum number of epochs for training neural network.</p></li>
            <li><p><strong>stop_criterion</strong> (<code>float</code>) – Minimum percent decrease in determined interval (below) to continue training. Used as early stopping criterion.</p></li>
            <li><p><strong>stop_criterion_window</strong> (<code>int</code>) – The window of data to apply the stopping criterion.</p></li>
            <li><p><strong>accuracy_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training accuracy is achieved, at which point, training ceases.</p></li>
            <li><p><strong>train_loss_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training loss is achieved, at which point, training ceases.</p></li>
            <li><p><strong>hinge_loss_t</strong> (<code>float</code>) – The per sequence loss minimum at which the loss of that sequence is not used to penalize the model anymore. In other words, once a per sequence loss has hit this value, it gets set to 0.0.</p></li>
            <li><p><strong>convergence</strong> (<code>str</code>) – This parameter determines which loss to assess the convergence criteria on. Options are 'validation' or 'training'. This is useful in the case one wants to change the convergence criteria on the training data when the training and validation partitions have been combined and used to training the model.</p></li>
            <li><p><strong>learning_rate</strong> (<code>float</code>) – The learning rate for training the neural network. Making this value larger will increase the rate of convergence but can introduce instability into training. For most, altering this value will not be necessary.</p></li>
            <li><p><strong>suppress_output</strong> (<code>bool</code>) – To suppress command line output with training statisitcs, set to True.</p></li>
            <li><p><strong>batch_seed</strong> (<code>int</code>) – For deterministic batching during training, set this value to an integer of choice.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_SS.Train" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">trainable_embedding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embedding_dim_aa</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">embedding_dim_genes</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">embedding_dim_hla</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">num_fc_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units_fc</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight_by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">class_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_only_seq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_gene</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_hla</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_of_net</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">graph_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drop_out_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">multisample_dropout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multisample_dropout_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">multisample_dropout_num_masks</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">epochs_min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">stop_criterion_window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">accuracy_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">train_loss_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hinge_loss_t</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">convergence</span><span class="o">=</span><span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">suppress_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">batch_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_SS.Train--train-single-sequence-classifier">Train Single-Sequence Classifier</h5>
<p>This method trains the network and saves features values at the end of training for downstream analysis.</p>
<p>The method also saves the per sequence predictions at the end of training in the variable self.predicted</p>
<p>The multiesample parameters are used to implement Multi-Sample Dropout at the final layer of the model as described in "Multi-Sample Dropout for Accelerated Training and Better Generalization" https://arxiv.org/abs/1905.09788. This method has been shown to improve generalization of deep neural networks as well as improve convergence.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>kernel</strong> (<code>int</code>) – Size of convolutional kernel for first layer of convolutions.</p></li>
            <li><p><strong>trainable_embedding</strong> (<code>bool</code>) – Toggle to control whether a trainable embedding layer is used or native one-hot representation for convolutional layers.</p></li>
            <li><p><strong>embedding_dim_aa</strong> (<code>int</code>) – Learned latent dimensionality of amino-acids.</p></li>
            <li><p><strong>embedding_dim_genes</strong> (<code>int</code>) – Learned latent dimensionality of VDJ genes</p></li>
            <li><p><strong>embedding_dim_hla</strong> (<code>int</code>) – Learned latent dimensionality of HLA</p></li>
            <li><p><strong>num_fc_layers</strong> (<code>int</code>) – Number of fully connected layers following convolutional layer.</p></li>
            <li><p><strong>units_fc</strong> (<code>int</code>) – Number of nodes per fully-connected layers following convolutional layer.</p></li>
            <li><p><strong>weight_by_class</strong> (<code>bool</code>) – Option to weight loss by the inverse of the class frequency. Useful for unbalanced classes.</p></li>
            <li><p><strong>class_weights</strong> (<code>dict</code>) – In order to specify custom weights for each class during training, one can provide a dictionary with these weights. i.e. {'A':1.0,'B':2.0'}</p></li>
            <li><p><strong>use_only_seq</strong> (<code>bool</code>) – To only use sequence feaures, set to True. This will turn off features learned from gene usage.</p></li>
            <li><p><strong>use_only_gene</strong> (<code>bool</code>) – To only use gene-usage features, set to True. This will turn off features from the sequences.</p></li>
            <li><p><strong>use_only_hla</strong> (<code>bool</code>) – To only use hla feaures, set to True.</p></li>
            <li><p><strong>size_of_net</strong> (<code>list or str</code>) – The convolutional layers of this network have 3 layers for which the use can modify the number of neurons per layer. The user can either specify the size of the network with the following options:</p>
<ul>
<li>small == [12,32,64] neurons for the 3 respective layers</li>
<li>medium == [32,64,128] neurons for the 3 respective layers</li>
<li>large == [64,128,256] neurons for the 3 respective layers</li>
<li>custom, where the user supplies a list with the number of nuerons for the respective layers
    i.e. [3,3,3] would have 3 neurons for all 3 layers.
    One can also adjust the number of layers for the convolutional stack by changing the length of
    this list. [3,3,3] = 3 layers, [3,3,3,3] = 4 layers.</li>
</ul></li>
            <li><p><strong>graph_seed</strong> (<code>int</code>) – For deterministic initialization of weights of the graph, set this to value of choice.</p></li>
            <li><p><strong>drop_out_rate</strong> (<code>float</code>) – drop out rate for fully connected layers</p></li>
            <li><p><strong>multisample_dropout</strong> (<code>bool</code>) – Set this parameter to True to implement this method.</p></li>
            <li><p><strong>multisample_dropout_rate</strong> (<code>float</code>) – The dropout rate for this multi-sample dropout layer.</p></li>
            <li><p><strong>multisample_dropout_num_masks</strong> (<code>int</code>) – The number of masks to sample from for the Multi-Sample Dropout layer.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Size of batch to be used for each training iteration of the net.</p></li>
            <li><p><strong>epochs_min</strong> (<code>int</code>) – Minimum number of epochs for training neural network.</p></li>
            <li><p><strong>stop_criterion</strong> (<code>float</code>) – Minimum percent decrease in determined interval (below) to continue training. Used as early stopping criterion.</p></li>
            <li><p><strong>stop_criterion_window</strong> (<code>int</code>) – The window of data to apply the stopping criterion.</p></li>
            <li><p><strong>accuracy_min</strong> (<code>loat</code>) – Optional parameter to allow alternative training strategy until minimum training accuracy is achieved, at which point, training ceases.</p></li>
            <li><p><strong>train_loss_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training loss is achieved, at which point, training ceases.</p></li>
            <li><p><strong>hinge_loss_t</strong> (<code>float</code>) – The per sequence loss minimum at which the loss of that sequence is not used to penalize the model anymore. In other words, once a per sequence loss has hit this value, it gets set to 0.0.</p></li>
            <li><p><strong>convergence</strong> (<code>str</code>) – This parameter determines which loss to assess the convergence criteria on. Options are 'validation' or 'training'. This is useful in the case one wants to change the convergence criteria on the training data when the training and validation partitions have been combined and used to training the model.</p></li>
            <li><p><strong>learning_rate</strong> (<code>float</code>) – The learning rate for training the neural network. Making this value larger will increase the rate of convergence but can introduce instability into training. For most, altering this value will not be necessary.</p></li>
            <li><p><strong>suppress_output</strong> (<code>bool</code>) – To suppress command line output with training statisitcs, set to True.</p></li>
            <li><p><strong>batch_seed</strong> (<code>int</code>) – For deterministic batching during training, set this value to an integer of choice.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="DeepTCR.DeepTCR.DeepTCR_U" class="doc doc-heading">
        <code>DeepTCR_U</code>



</h3>

    <div class="doc doc-contents ">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_U.KNN_Repertoire_Classifier" class="doc doc-heading">
<code class="highlight language-python"><span class="n">KNN_Repertoire_Classifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">distance_metric</span><span class="o">=</span><span class="s1">&#39;KL&#39;</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot_metrics</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;violin&#39;</span><span class="p">,</span> <span class="n">by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Load_Prev_Data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;F1_Score&#39;</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">])</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_U.KNN_Repertoire_Classifier--k-nearest-neighbor-repertoire-classifier">K-Nearest Neighbor Repertoire Classifier</h5>
<p>This method uses a K-Nearest Neighbor Classifier to assess the ability to predict a repertoire label given the structural distribution of the repertoire.The method returns AUC,Precision,Recall, and F1 Scores for all classes.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>folds</strong> (<code>int</code>) – Number of folds to train/test K-Nearest Classifier.</p></li>
            <li><p><strong>distance_metric</strong> (<code>str</code>) – Provided distance metric to determine repertoire-level distance from cluster proportions. Options include = (KL,correlation,euclidean,wasserstein,JS).</p></li>
            <li><p><strong>sample</strong> (<code>int</code>) – For large numbers of sequences, to obtain a faster clustering solution, one can sub-sample a number of sequences and then use k-nearest neighbors to assign other sequences.</p></li>
            <li><p><strong>n_jobs</strong> (<code>int</code>) – Number of processes to use for parallel operations.</p></li>
            <li><p><strong>plot_metrics</strong> (<code>bool</code>) – Toggle to show the performance metrics</p></li>
            <li><p><strong>plot_type</strong> (<code>str</code>) – Type of plot as taken by seaborn.catplot for kind parameter: options include (strip,swarm,box,violin,boxen,point,bar,count)</p></li>
            <li><p><strong>by_class</strong> (<code>bool</code>) – Toggle to show the performance metrics by class.</p></li>
            <li><p><strong>Load_Prev_Data</strong> (<code>bool</code>) – If method has been run before, one can load previous data from clustering step to move to KNN step faster. Can be useful when trying different distance methods to find optimizal distance metric for a given dataset.</p></li>
            <li><p><strong>metrics</strong> (<code>list</code>) – List of performance measures one wants to compute. options include AUC, Precision, Recall, F1_Score</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Performance Metrics</p>
<ul>
<li>self.KNN_Repertoire_DF (Pandas dataframe)` – Dataframe with all metrics of performance organized by the class label,
metric (i.e. AUC), k-value (from k-nearest neighbors), and the value of the
performance metric.</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>      <hr />

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_U.KNN_Sequence_Classifier" class="doc doc-heading">
<code class="highlight language-python"><span class="n">KNN_Sequence_Classifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k_values</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">276</span><span class="p">,</span> <span class="mi">301</span><span class="p">,</span> <span class="mi">326</span><span class="p">,</span> <span class="mi">351</span><span class="p">,</span> <span class="mi">376</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">426</span><span class="p">,</span> <span class="mi">451</span><span class="p">,</span> <span class="mi">476</span><span class="p">],</span> <span class="n">rep</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">plot_metrics</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;violin&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;F1_Score&#39;</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">],</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Load_Prev_Data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_U.KNN_Sequence_Classifier--k-nearest-neighbor-sequence-classifier">K-Nearest Neighbor Sequence Classifier</h5>
<p>This method uses a K-Nearest Neighbor Classifier to assess the ability to predict a sequence label given its sequence features.The method returns AUC,Precision,Recall, and F1 Scores for all classes.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>folds</strong> (<code>int</code>) – Number of folds to train/test K-Nearest Classifier.</p></li>
            <li><p><strong>k_values</strong> (<code>list</code>) – List of k for KNN algorithm to assess performance metrics across.</p></li>
            <li><p><strong>rep</strong> (<code>int</code>) – Number of iterations to train KNN classifier for each k-value.</p></li>
            <li><p><strong>plot_metrics</strong> (<code>bool</code>) – Toggle to show the performance metrics</p></li>
            <li><p><strong>plot_type</strong> (<code>str</code>) – Type of plot as taken by seaborn.catplot for kind parameter: options include (strip,swarm,box,violin,boxen,point,bar,count)</p></li>
            <li><p><strong>by_class</strong> (<code>bool</code>) – Toggle to show the performance metrics by class.</p></li>
            <li><p><strong>metrics</strong> (<code>list</code>) – List of performance measures one wants to compute. Options include AUC, Precision, Recall, F1_Score</p></li>
            <li><p><strong>n_jobs</strong> (<code>int</code>) – Number of workers to set for KNeighborsClassifier.</p></li>
            <li><p><strong>Load_Prev_Data</strong> (<code>bool</code>) – To make new figures from old previously run analysis, set this value to True after running the method for the first time. This will load previous performance metrics from previous run.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Performance Metrics</p>
<ul>
<li>self.KNN_Sequence_DF (Pandas dataframe)` – Dataframe with all metrics of performance organized by the class label,
metric (i.e. AUC), k-value (from k-nearest neighbors), and the value of the
performance metric.</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>      <hr />

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_U.Train_VAE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Train_VAE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latent_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">trainable_embedding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embedding_dim_aa</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">embedding_dim_genes</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">embedding_dim_hla</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">use_only_seq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_gene</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_hla</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_of_net</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">latent_alpha</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">sparsity_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">var_explained</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">epochs_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">stop_criterion_window</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">accuracy_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suppress_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">split_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Load_Prev_Data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_U.Train_VAE--train-variational-autoencoder-vae">Train Variational Autoencoder (VAE)</h5>
<p>This method trains the network and saves features values for sequences for a variety of downstream analyses that can either be done within the DeepTCR framework or by the user by simplying extracting out the learned representations.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>latent_dim</strong> (<code>int</code>) – Number of latent dimensions for VAE.</p></li>
            <li><p><strong>kernel</strong> (<code>int</code>) – The motif k-mer of the first convolutional layer of the graph.</p></li>
            <li><p><strong>trainable_embedding</strong> (<code>bool</code>) – Toggle to control whether a trainable embedding layer is used or native one-hot representation for convolutional layers.</p></li>
            <li><p><strong>embedding_dim_aa</strong> (<code>int</code>) – Learned latent dimensionality of amino-acids.</p></li>
            <li><p><strong>embedding_dim_genes</strong> (<code>int</code>) – Learned latent dimensionality of VDJ genes</p></li>
            <li><p><strong>embedding_dim_hla</strong> (<code>int</code>) – Learned latent dimensionality of HLA</p></li>
            <li><p><strong>use_only_seq</strong> (<code>bool</code>) – To only use sequence feaures, set to True.</p></li>
            <li><p><strong>use_only_gene</strong> (<code>bool</code>) – To only use gene-usage features, set to True.</p></li>
            <li><p><strong>use_only_hla</strong> (<code>bool</code>) – To only use hla feaures, set to True.</p></li>
            <li><p><strong>size_of_net</strong> (<code>list or str</code>) – The convolutional layers of this network have 3 layers for which the use can modify the number of neurons per layer. The user can either specify the size of the network with the following options:</p>
<ul>
<li>small == [12,32,64] neurons for the 3 respective layers</li>
<li>medium == [32,64,128] neurons for the 3 respective layers</li>
<li>large == [64,128,256] neurons for the 3 respective layers</li>
<li>custom, where the user supplies a list with the number of nuerons for the respective layers
    i.e. [3,3,3] would have 3 neurons for all 3 layers.
    One can also adjust the number of layers for the convolutional stack by changing the length of
    this list. [3,3,3] = 3 layers, [3,3,3,3] = 4 layers.</li>
</ul></li>
            <li><p><strong>latent_alpha</strong> (<code>float</code>) – Penalty coefficient for latent loss. This value changes the degree of latent regularization on the VAE.</p></li>
            <li><p><strong>sparsity_alpha</strong> (<code>float</code>) – When training an autoencoder, the number of latent nodes required to model the underlying distribution of the data is often arrived to by trial and error and tuning this hyperparameter. In many cases, by using too many latent nodes, one my fit the distribution but downstream analysis tasks may be computationally burdensome with i.e. 256 latent features. Additionally, there can be a high level of colinearlity among these latent features. In our implemnetation of VAE, we introduce this concept of a sparsity constraint which turns off latent nodes in a soft fashion throughout straining and acts as another mode of regularization to find the minimal number of latent features to model the underlying distribution. Following training, one can set the var_explained parameter to select the number of latent nodes required  to cover X percent variation explained akin to PCA analysis. This results in a lower dimensional space and more linearly indepeendent latent space. Good starting value is 1.0.</p></li>
            <li><p><strong>var_explained</strong> (<code>float (0-1.0</code>) – Following training, one can select the number of latent features that explain N% of the variance in the data. The output of the method will be the features in order of the explained variance.</p></li>
            <li><p><strong>graph_seed</strong> (<code>int</code>) – For deterministic initialization of weights of the graph, set this to value of choice.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Size of batch to be used for each training iteration of the net.</p></li>
            <li><p><strong>epochs_min</strong> (<code>int</code>) – The minimum number of epochs to train the autoencoder.</p></li>
            <li><p><strong>stop_criterion</strong> (<code>float</code>) – Minimum percent decrease in determined interval (below) to continue training. Used as early stopping criterion.</p></li>
            <li><p><strong>stop_criterion_window</strong> (<code>int</code>) – The window of data to apply the stopping criterion.</p></li>
            <li><p><strong>accuracy_min</strong> (<code>float</code>) – Minimum reconstruction accuracy before terminating training.</p></li>
            <li><p><strong>suppress_output</strong> (<code>bool</code>) – To suppress command line output with training statisitcs, set to True.</p></li>
            <li><p><strong>split_seed</strong> (<code>int</code>) – For deterministic batching of data during training, one can set this parameter to value of choice.</p></li>
            <li><p><strong>Load_Prev_Data</strong> (<code>bool</code>) – Load previous feature data from prior training.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`VAE Features</p>
<ul>
<li>
<p>self.features (array)` – An array that contains n x latent_dim containing features for all sequences</p>
</li>
<li>
<p>self.explained_variance_ (array):
The explained variance for the N number of latent features in order of descending value.</p>
</li>
<li>
<p>self.explained_variance_ratio_ (array):
The explained variance ratio for the N number of latent features in order of descending value.</p>
</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>      <hr />

    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="DeepTCR.DeepTCR.DeepTCR_WF" class="doc doc-heading">
        <code>DeepTCR_WF</code>



</h3>

    <div class="doc doc-contents ">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_WF.Get_Train_Valid_Test" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Get_Train_Valid_Test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">LOO</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">combine_train_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_perm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_WF.Get_Train_Valid_Test--trainvalidtest-splits">Train/Valid/Test Splits.</h5>
<p>Divide data for train, valid, test set. In general, training is used to train model parameters, validation is used to set early stopping, and test acts as blackbox independent test set.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>test_size</strong> (<code>float</code>) – Fraction of sample to be used for valid and test set. For example, if set to 0.25, 25% of the data will be set aside for validation and testing sets. In other words, 75% of the data is used for training.</p></li>
            <li><p><strong>LOO</strong> (<code>int</code>) – Number of samples to leave-out in Leave-One-Out Cross-Validation. For example, when set to 2, 2 samples will be left out for the validation set and 2 samples will be left out for the test set.</p></li>
            <li><p><strong>combine_train_valid</strong> (<code>bool</code>) – To combine the training and validation partitions into one which will be used for training and updating the model parameters, set this to True. This will also set the validation partition to the test partition. In other words, new train set becomes (original train + original valid) and then new valid = original test partition, new test = original test partition. Therefore, if setting this parameter to True, change one of the training parameters to set the stop training criterion (i.e. train_loss_min) to stop training based on the train set. If one does not chanage the stop training criterion, the decision of when to stop training will be based on the test data (which is considered a form of over-fitting).</p></li>
            <li><p><strong>random_perm</strong> (<code>bool</code>) – To do random permutation testing, one can set this parameter to True and this will shuffle the labels.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_WF.K_Fold_CrossVal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">K_Fold_CrossVal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">combine_train_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">seeds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_concepts</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">trainable_embedding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embedding_dim_aa</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">embedding_dim_genes</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">embedding_dim_hla</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">num_fc_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units_fc</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight_by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">class_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_only_seq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_gene</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_hla</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_of_net</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">graph_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qualitative_agg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quantitative_agg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_agg_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units_agg</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">drop_out_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">multisample_dropout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multisample_dropout_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">multisample_dropout_num_masks</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">batch_size_update</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epochs_min</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">stop_criterion_window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">accuracy_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">train_loss_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hinge_loss_t</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">convergence</span><span class="o">=</span><span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">suppress_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_criteria</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">l2_reg</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">batch_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsample_by_freq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subsample_valid_test</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_WF.K_Fold_CrossVal--k_fold-cross-validation-for-whole-sample-classifier">K_Fold Cross-Validation for Whole Sample Classifier</h5>
<p>If the number of samples is small but training the whole sample classifier, one
can use K_Fold Cross Validation to train on all but one before assessing
predictive performance.After this method is run, the AUC_Curve method can be run to
assess the overall performance.</p>
<p>The two MIL options alter how the predictive signatures in the neural network are aggregated to make a prediction about the repertoire. If qualitative_agg or quantitative_agg are set to True, this will include these different types of aggregation in the predcitions. One can set either to True or both to True and this will allow a user to incorporate features from multiple modes of aggregation. See below for further details on these methods of aggregation across the sequences of a repertoire.</p>
<p>The multiesample parameters are used to implement Multi-Sample Dropout at the final layer of the model as described in "Multi-Sample Dropout for Accelerated Training and Better Generalization" https://arxiv.org/abs/1905.09788. This method has been shown to improve generalization of deep neural networks as well as improve convergence.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>folds</strong> (<code>int</code>) – Number of Folds</p></li>
            <li><p><strong>combine_train_valid</strong> (<code>bool</code>) – To combine the training and validation partitions into one which will be used for training and updating the model parameters, set this to True. This will also set the validation partition to the test partition. In other words, new train set becomes (original train + original valid) and then new valid = original test partition, new test = original test partition. Therefore, if setting this parameter to True, change one of the training parameters to set the stop training criterion (i.e. train_loss_min) to stop training based on the train set. If one does not chanage the stop training criterion, the decision of when to stop training will be based on the test data (which is considered a form of over-fitting).</p></li>
            <li><p><strong>seeds</strong> (<code>nd.array</code>) – In order to set a deterministic train/test split over the K-Fold Simulations, one can provide an array of seeds for each K-fold simulation. This will result in the same train/test split over the N Fold simulations. This parameter, if provided, should have the same size of the value of folds.</p></li>
            <li><p><strong>kernel</strong> (<code>int</code>) – Size of convolutional kernel for first layer of convolutions.</p></li>
            <li><p><strong>num_concepts</strong> (<code>int</code>) – Number of concepts for multi-head attention mechanism. Depending on the expected heterogeneity of the repertoires being analyed, one can adjust this hyperparameter.</p></li>
            <li><p><strong>trainable_embedding</strong> (<code>bool</code>) – Toggle to control whether a trainable embedding layer is used or native one-hot representation for convolutional layers.</p></li>
            <li><p><strong>embedding_dim_aa</strong> (<code>int</code>) – Learned latent dimensionality of amino-acids.</p></li>
            <li><p><strong>embedding_dim_genes</strong> (<code>int</code>) – Learned latent dimensionality of VDJ genes</p></li>
            <li><p><strong>embedding_dim_hla</strong> (<code>int</code>) – Learned latent dimensionality of HLA</p></li>
            <li><p><strong>num_fc_layers</strong> (<code>int</code>) – Number of fully connected layers following convolutional layer.</p></li>
            <li><p><strong>units_fc</strong> (<code>int</code>) – Number of nodes per fully-connected layers following convolutional layer.</p></li>
            <li><p><strong>weight_by_class</strong> (<code>bool</code>) – Option to weight loss by the inverse of the class frequency. Useful for unbalanced classes.</p></li>
            <li><p><strong>class_weights</strong> (<code>dict</code>) – In order to specify custom weights for each class during training, one can provide a dictionary with these weights.i.e. {'A':1.0,'B':2.0'}</p></li>
            <li><p><strong>use_only_seq</strong> (<code>bool</code>) – To only use sequence feaures, set to True. This will turn off features learned from gene usage.</p></li>
            <li><p><strong>use_only_gene</strong> (<code>bool</code>) – To only use gene-usage features, set to True. This will turn off features from the sequences.</p></li>
            <li><p><strong>use_only_hla</strong> (<code>bool</code>) – To only use hla feaures, set to True.</p></li>
            <li><p><strong>size_of_net</strong> (<code>list or str</code>) – The convolutional layers of this network have 3 layers for which the use can modify the number of neurons per layer. The user can either specify the size of the network with the following options:</p>
<ul>
<li>small == [12,32,64] neurons for the 3 respective layers</li>
<li>medium == [32,64,128] neurons for the 3 respective layers</li>
<li>large == [64,128,256] neurons for the 3 respective layers</li>
<li>custom, where the user supplies a list with the number of nuerons for the respective layers
    i.e. [3,3,3] would have 3 neurons for all 3 layers.</li>
</ul></li>
            <li><p><strong>graph_seed</strong> (<code>int</code>) – For deterministic initialization of weights of the graph, set this to value of choice.</p></li>
            <li><p><strong>qualitative_agg</strong> (<code>bool</code>) – If set to True, the model will aggregate the feature values per repertoire weighted by frequency of each TCR. This is considered a 'qualitative' aggregation as the prediction of the repertoire is based on the relative distribution of the repertoire. In other words, this type of aggregation is a count-independent measure of aggregation. This is the mode of aggregation that has been more thoroughly tested across multiple scientific examples.</p></li>
            <li><p><strong>quantitative_agg</strong> (<code>bool</code>) – If set to True, the model will aggregate the feature values per repertoire weighted by counts of each TCR. This is considered a 'quantitative' aggregation as the prediction of the repertoire is based on teh absolute distribution of the repertoire. In other words, this type of aggregation is a count-dependent measure of aggregation. If one believes the counts are important for the predictive value of the model, one can set this parameter to True.</p></li>
            <li><p><strong>num_agg_layers</strong> (<code>int</code>) – Following the aggregation layer in the network, one can choose to add more fully-connected layers before the final classification layer. This parameter will set how many layers to add after aggregation. This likely is helpful when using both types of aggregation (as detailed above) to combine those feature values.</p></li>
            <li><p><strong>units_agg</strong> (<code>int</code>) – For the fully-connected layers after aggregation, this parameter sets the number of units/nodes per layer.</p></li>
            <li><p><strong>drop_out_rate</strong> (<code>float</code>) – drop out rate for fully connected layers</p></li>
            <li><p><strong>multisample_dropout_rate</strong> (<code>float</code>) – The dropout rate for this multi-sample dropout layer.</p></li>
            <li><p><strong>multisample_dropout_num_masks</strong> (<code>int</code>) – The number of masks to sample from for the Multi-Sample Dropout layer.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Size of batch to be used for each training iteration of the net.</p></li>
            <li><p><strong>batch_size_update</strong> (<code>int</code>) – In the case that the size of the samples are very large, one may not want to update the weights of the network as often as batches are put onto the gpu. Therefore, if one wants to update the weights less often than how often the batches of data are put onto the gpu, one can set this parameter to something other than None. An example would be if batch_size is set to 5 and batch_size_update is set to 30, while only 5 samples will be put on the gpu at a time, the weights will only be updated after 30 samples have been put on the gpu. This parameter is only relevant when using gpu's for training and there are memory constraints from very large samples.</p></li>
            <li><p><strong>epochs_min</strong> (<code>int</code>) – Minimum number of epochs for training neural network.</p></li>
            <li><p><strong>stop_criterion</strong> (<code>float</code>) – Minimum percent decrease in determined interval (below) to continue training. Used as early stopping criterion.</p></li>
            <li><p><strong>stop_criterion_window</strong> (<code>int</code>) – The window of data to apply the stopping criterion.</p></li>
            <li><p><strong>accuracy_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training accuracy is achieved, at which point, training ceases.</p></li>
            <li><p><strong>train_loss_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training loss is achieved, at which point, training ceases.</p></li>
            <li><p><strong>hinge_loss_t</strong> (<code>float</code>) – The per sample loss minimum at which the loss of that sample is not used to penalize the model anymore. In other words, once a per sample loss has hit this value, it gets set to 0.0.</p></li>
            <li><p><strong>convergence</strong> (<code>str</code>) – This parameter determines which loss to assess the convergence criteria on. Options are 'validation' or 'training'. This is useful in the case one wants to change the convergence criteria on the training data when the training and validation partitions have been combined and used to training the model.</p></li>
            <li><p><strong>learning_rate</strong> (<code>float</code>) – The learning rate for training the neural network. Making this value larger will increase the rate of convergence but can introduce instability into training. For most, altering this value will not be necessary.</p></li>
            <li><p><strong>suppress_output</strong> (<code>bool</code>) – To suppress command line output with training statisitcs, set to True.</p></li>
            <li><p><strong>l2_reg</strong> (<code>float</code>) – When training the repertoire classifier, it may help to utilize L2 regularization to prevent sample-specific overfitting of the model. By setting the value of this parameter (i.e. 0.01), one will introduce L2 regularization through al but the last layer of the network.</p></li>
            <li><p><strong>batch_seed</strong> (<code>int</code>) – For deterministic batching during training, set this value to an integer of choice.</p></li>
            <li><p><strong>subsample</strong> (<code>int</code>) – Number of sequences to sub-sample from repertoire during training to improve speed of convergence as well as being a form of regularization.</p></li>
            <li><p><strong>subsample_by_freq</strong> (<code>bool</code>) – Whether to sub-sample randomly in the repertoire or as a function of the frequency of the TCR.</p></li>
            <li><p><strong>subsample_valid_test</strong> (<code>bool</code>) – Whether to sub-sample during valid/test cohorts while training. This is mostly as well to improve speed to convergence and generalizability.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_WF.Monte_Carlo_CrossVal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Monte_Carlo_CrossVal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">LOO</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">combine_train_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_perm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">seeds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_concepts</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">trainable_embedding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embedding_dim_aa</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">embedding_dim_genes</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">embedding_dim_hla</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">num_fc_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units_fc</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight_by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">class_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_only_seq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_gene</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_hla</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_of_net</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">graph_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qualitative_agg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quantitative_agg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_agg_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units_agg</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">drop_out_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">multisample_dropout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multisample_dropout_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">multisample_dropout_num_masks</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">batch_size_update</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epochs_min</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">stop_criterion_window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">accuracy_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">train_loss_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hinge_loss_t</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">convergence</span><span class="o">=</span><span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">suppress_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_criteria</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">l2_reg</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">batch_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsample_by_freq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subsample_valid_test</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_WF.Monte_Carlo_CrossVal--monte-carlo-cross-validation-for-whole-sample-classifier">Monte Carlo Cross-Validation for Whole Sample Classifier</h5>
<p>If the number of samples is small but training the whole sample classifier, one
can use Monte Carlo Cross Validation to train a number of iterations before assessing
predictive performance.After this method is run, the AUC_Curve method can be run to
assess the overall performance.</p>
<p>The two MIL options alter how the predictive signatures in the neural network are aggregated to make a prediction about the repertoire. If qualitative_agg or quantitative_agg are set to True, this will include these different types of aggregation in the predcitions. One can set either to True or both to True and this will allow a user to incorporate features from multiple modes of aggregation. See below for further details on these methods of aggregation across the sequences of a repertoire.</p>
<p>The multiesample parameters are used to implement Multi-Sample Dropout at the final layer of the model as described in "Multi-Sample Dropout for Accelerated Training and Better Generalization" https://arxiv.org/abs/1905.09788. This method has been shown to improve generalization of deep neural networks as well as improve convergence.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>folds</strong> (<code>int</code>) – Number of iterations for Cross-Validation</p></li>
            <li><p><strong>test_size</strong> (<code>float</code>) – Fraction of sample to be used for valid and test set.</p></li>
            <li><p><strong>LOO</strong> (<code>int</code>) – Number of samples to leave-out in Leave-One-Out Cross-Validation</p></li>
            <li><p><strong>combine_train_valid</strong> (<code>bool</code>) – To combine the training and validation partitions into one which will be used for training and updating the model parameters, set this to True. This will also set the validation partition to the test partition. In other words, new train set becomes (original train + original valid) and then new valid = original test partition, new test = original test partition. Therefore, if setting this parameter to True, change one of the training parameters to set the stop training criterion (i.e. train_loss_min) to stop training based on the train set. If one does not chanage the stop training criterion, the decision of when to stop training will be based on the test data (which is considered a form of over-fitting).</p></li>
            <li><p><strong>random_perm</strong> (<code>bool</code>) – To do random permutation testing, one can set this parameter to True and this will shuffle the labels.</p></li>
            <li><p><strong>seeds</strong> (<code>nd.array</code>) – In order to set a deterministic train/test split over the Monte-Carlo Simulations, one can provide an array of seeds for each MC simulation. This will result in the same train/test split over the N MC simulations. This parameter, if provided, should have the same size of the value of folds.</p></li>
            <li><p><strong>kernel</strong> (<code>int</code>) – Size of convolutional kernel for first layer of convolutions.</p></li>
            <li><p><strong>num_concepts</strong> (<code>int</code>) – Number of concepts for multi-head attention mechanism. Depending on the expected heterogeneity of the repertoires being analyed, one can adjust this hyperparameter.</p></li>
            <li><p><strong>trainable_embedding</strong> (<code>bool</code>) – Toggle to control whether a trainable embedding layer is used or native one-hot representation for convolutional layers.</p></li>
            <li><p><strong>embedding_dim_aa</strong> (<code>int</code>) – Learned latent dimensionality of amino-acids.</p></li>
            <li><p><strong>embedding_dim_genes</strong> (<code>int</code>) – Learned latent dimensionality of VDJ genes</p></li>
            <li><p><strong>embedding_dim_hla</strong> (<code>int</code>) – Learned latent dimensionality of HLA</p></li>
            <li><p><strong>num_fc_layers</strong> (<code>int</code>) – Number of fully connected layers following convolutional layer.</p></li>
            <li><p><strong>units_fc</strong> (<code>int</code>) – Number of nodes per fully-connected layers following convolutional layer.</p></li>
            <li><p><strong>weight_by_class</strong> (<code>bool</code>) – Option to weight loss by the inverse of the class frequency. Useful for unbalanced classes.</p></li>
            <li><p><strong>class_weights</strong> (<code>dict</code>) – In order to specify custom weights for each class during training, one can provide a dictionary with these weights.i.e. {'A':1.0,'B':2.0'}</p></li>
            <li><p><strong>use_only_seq</strong> (<code>bool</code>) – To only use sequence feaures, set to True. This will turn off features learned from gene usage.</p></li>
            <li><p><strong>use_only_gene</strong> (<code>bool</code>) – To only use gene-usage features, set to True. This will turn off features from the sequences.</p></li>
            <li><p><strong>use_only_hla</strong> (<code>bool</code>) – To only use hla feaures, set to True.</p></li>
            <li><p><strong>size_of_net</strong> (<code>list or str</code>) – The convolutional layers of this network have 3 layers for which the use can modify the number of neurons per layer. The user can either specify the size of the network with the following options:</p>
<ul>
<li>small == [12,32,64] neurons for the 3 respective layers</li>
<li>medium == [32,64,128] neurons for the 3 respective layers</li>
<li>large == [64,128,256] neurons for the 3 respective layers</li>
<li>custom, where the user supplies a list with the number of nuerons for the respective layers
    i.e. [3,3,3] would have 3 neurons for all 3 layers.</li>
</ul></li>
            <li><p><strong>graph_seed</strong> (<code>int</code>) – For deterministic initialization of weights of the graph, set this to value of choice.</p></li>
            <li><p><strong>qualitative_agg</strong> (<code>bool</code>) – If set to True, the model will aggregate the feature values per repertoire weighted by frequency of each TCR. This is considered a 'qualitative' aggregation as the prediction of the repertoire is based on the relative distribution of the repertoire. In other words, this type of aggregation is a count-independent measure of aggregation. This is the mode of aggregation that has been more thoroughly tested across multiple scientific examples.</p></li>
            <li><p><strong>quantitative_agg</strong> (<code>bool</code>) – If set to True, the model will aggregate the feature values per repertoire weighted by counts of each TCR. This is considered a 'quantitative' aggregation as the prediction of the repertoire is based on teh absolute distribution of the repertoire. In other words, this type of aggregation is a count-dependent measure of aggregation. If one believes the counts are important for the predictive value of the model, one can set this parameter to True.</p></li>
            <li><p><strong>num_agg_layers</strong> (<code>int</code>) – Following the aggregation layer in the network, one can choose to add more fully-connected layers before the final classification layer. This parameter will set how many layers to add after aggregation. This likely is helpful when using both types of aggregation (as detailed above) to combine those feature values.</p></li>
            <li><p><strong>units_agg</strong> (<code>int</code>) – For the fully-connected layers after aggregation, this parameter sets the number of units/nodes per layer.</p></li>
            <li><p><strong>drop_out_rate</strong> (<code>float</code>) – drop out rate for fully connected layers</p></li>
            <li><p><strong>multisample_dropout_rate</strong> (<code>float</code>) – The dropout rate for this multi-sample dropout layer.</p></li>
            <li><p><strong>multisample_dropout_num_masks</strong> (<code>int</code>) – The number of masks to sample from for the Multi-Sample Dropout layer.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Size of batch to be used for each training iteration of the net.</p></li>
            <li><p><strong>batch_size_update</strong> (<code>int</code>) – In the case that the size of the samples are very large, one may not want to update the weights of the network as often as batches are put onto the gpu. Therefore, if one wants to update the weights less often than how often the batches of data are put onto the gpu, one can set this parameter to something other than None. An example would be if batch_size is set to 5 and batch_size_update is set to 30, while only 5 samples will be put on the gpu at a time, the weights will only be updated after 30 samples have been put on the gpu. This parameter is only relevant when using gpu's for training and there are memory constraints from very large samples.</p></li>
            <li><p><strong>epochs_min</strong> (<code>int</code>) – Minimum number of epochs for training neural network.</p></li>
            <li><p><strong>stop_criterion</strong> (<code>float</code>) – Minimum percent decrease in determined interval (below) to continue training. Used as early stopping criterion.</p></li>
            <li><p><strong>stop_criterion_window</strong> (<code>int</code>) – The window of data to apply the stopping criterion.</p></li>
            <li><p><strong>accuracy_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training accuracy is achieved, at which point, training ceases.</p></li>
            <li><p><strong>train_loss_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training loss is achieved, at which point, training ceases.</p></li>
            <li><p><strong>hinge_loss_t</strong> (<code>float</code>) – The per sample loss minimum at which the loss of that sample is not used to penalize the model anymore. In other words, once a per sample loss has hit this value, it gets set to 0.0.</p></li>
            <li><p><strong>convergence</strong> (<code>str</code>) – This parameter determines which loss to assess the convergence criteria on. Options are 'validation' or 'training'. This is useful in the case one wants to change the convergence criteria on the training data when the training and validation partitions have been combined and used to training the model.</p></li>
            <li><p><strong>learning_rate</strong> (<code>float</code>) – The learning rate for training the neural network. Making this value larger will increase the rate of convergence but can introduce instability into training. For most, altering this value will not be necessary.</p></li>
            <li><p><strong>suppress_output</strong> (<code>bool</code>) – To suppress command line output with training statisitcs, set to True.</p></li>
            <li><p><strong>l2_reg</strong> (<code>float</code>) – When training the repertoire classifier, it may help to utilize L2 regularization to prevent sample-specific overfitting of the model. By setting the value of this parameter (i.e. 0.01), one will introduce L2 regularization through all but the last layer of the network.</p></li>
            <li><p><strong>batch_seed</strong> (<code>int</code>) – For deterministic batching during training, set this value to an integer of choice.</p></li>
            <li><p><strong>subsample</strong> (<code>int</code>) – Number of sequences to sub-sample from repertoire during training to improve speed of convergence as well as being a form of regularization.</p></li>
            <li><p><strong>subsample_by_freq</strong> (<code>bool</code>) – Whether to sub-sample randomly in the repertoire or as a function of the frequency of the TCR.</p></li>
            <li><p><strong>subsample_valid_test</strong> (<code>bool</code>) – Whether to sub-sample during valid/test cohorts while training. This is mostly as well to improve speed to convergence and generalizability.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`MC Predictions</p>
<ul>
<li>self.DFs_pred (dict of dataframes)` – This method returns the samples in the test sets of the Monte-Carlo and their
predicted probabilities for each class.</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_WF.Sample_Inference" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Sample_Inference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">beta_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">j_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hla</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_WF.Sample_Inference--predicting-outputs-of-samplerepertoire-model-on-new-data">Predicting outputs of sample/repertoire model on new data</h5>
<p>This method allows a user to take a pre-trained sample/repertoire classifier and generate outputs from the model on new data. This will return predicted probabilites for the given classes for the new data. If the model has been trained in Monte-Carlo or K-Fold Cross-Validation, there will be a model created for each iteration of the cross-validation. if the 'models' parameter is left as None, this method will conduct inference for all models trained in cross-validation and output the average predicted value per sample along with the distribution of predictions for futher downstream use. For example, by looking at the distribution of predictions for a given sample over all models trained, one can determine which samples have a high level of certainty in their predictions versus those with lower level of certainty. In essense, by training a multiple models in cross-validation schemes, this can allow the user to generate a distribution of predictions on a per-sample basis which provides a better understanding of the prediction. Alternatively, one can choose to fill in the the models parameter with a list of models the user wants to use for inference.</p>
<p>To load data from directories, one can use the Get_Data method from the base class to automatically format the data into the proper format to be then input into this method.</p>
<p>One can also use this method to get per-sequence predictions from the sample/repertoire classifier. To do this, provide all inputs except for sample_labels. The method will then return an array of dimensionality [N,n_classes] where N is the number of sequences provided. When using the method in this way, be sure to change the batch_size is adjusted to a larger value as 10 sequences per batch will be rather slow. We recommend changing into the order of thousands (i.e. 10 - 100k).</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>sample_labels</strong> (<code>ndarray of strings</code>) – A 1d array with sample labels for the sequence.</p></li>
            <li><p><strong>alpha_sequences</strong> (<code>ndarray of strings</code>) – A 1d array with the sequences for inference for the alpha chain.</p></li>
            <li><p><strong>beta_sequences</strong> (<code>ndarray of strings</code>) – A 1d array with the sequences for inference for the beta chain.</p></li>
            <li><p><strong>v_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the v-beta genes for inference.</p></li>
            <li><p><strong>d_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the d-beta genes for inference.</p></li>
            <li><p><strong>j_beta</strong> (<code>ndarray of strings</code>) – A 1d array with the j-beta genes for inference.</p></li>
            <li><p><strong>v_alpha</strong> (<code>ndarray of strings</code>) – A 1d array with the v-alpha genes for inference.</p></li>
            <li><p><strong>j_alpha</strong> (<code>ndarray of strings</code>) – A 1d array with the j-alpha genes for inference.</p></li>
            <li><p><strong>counts</strong> (<code>ndarray of ints</code>) – A 1d array with the counts for each sequence.</p></li>
            <li><p><strong>freq</strong> (<code>ndarray of float values</code>) – A 1d array with the frequencies for each sequence.</p></li>
            <li><p><strong>hla</strong> (<code>ndarray of tuples/arrays</code>) – To input the hla context for each sequence fed into DeepTCR, this will need to formatted as an ndarray that is (N,) for each sequence where each entry is a tuple or array of strings referring to the alleles seen for that sequence. ('A<em>01:01', 'A</em>11:01', 'B<em>35:01', 'B</em>35:02', 'C*04:01')</p>
<ul>
<li>If the model used for inference was trained to use HLA-supertypes, one should still enter the HLA in the format it was provided to the original model (i.e. A0101). This mehthod will then convert those HLA alleles into the appropriaet supertype designation. The HLA alleles DO NOT need to be provided to this method in the supertype designation.</li>
</ul></li>
            <li><p><strong>p</strong> (<code>multiprocessing pool object</code>) – a pre-formed pool object can be passed to method for multiprocessing tasks.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Batch size for inference.</p></li>
            <li><p><strong>models</strong> (<code>list</code>) – List of models in Name_Of_Object/models to use for inference. If left as None, this method will use all models in that directory.</p></li>
            <li><p><strong>return_dist</strong> (<code>bool</code>) – If the user wants to also return teh distribution of sample/sequence predictions over all models used for inference, one should set this value to True.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Predictions</p>
<ul>
<li>
<p>self.Inference_Sample_List (ndarray)` – An array with the sample list corresponding the predicted probabilities.</p>
</li>
<li>
<p>self.Inference_Pred (ndarray):
An array with the predicted probabilites for all classes. These represent the average probability
of all models used for inference.</p>
</li>
<li>
<p>self.Inference_Pred_Dict (dict):
A dictionary of predicted probabilities for the respective classes. These represent the average probability
of all models used for inference.</p>
</li>
<li>
<p>self.Inference_Pred_Dist (ndarray):
An array with the predicted probabilites for all classes on a per model basis.
shape = [Number of Models, Number of Samples, Number of Classes]</p>
</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>      <p>If sample_labels is not provided, the method will perform per-sequence predictions and will return the an array
of [N,n_classes]. If return_dist is set to True, the method will return two outputs. One containing the mean predictions
and the other containing the full distribution over all models.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.DeepTCR_WF.Train" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_concepts</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">trainable_embedding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embedding_dim_aa</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">embedding_dim_genes</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">embedding_dim_hla</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">num_fc_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units_fc</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight_by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">class_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_only_seq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_gene</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_only_hla</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_of_net</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">graph_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qualitative_agg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quantitative_agg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_agg_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units_agg</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">drop_out_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">multisample_dropout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multisample_dropout_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">multisample_dropout_num_masks</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">batch_size_update</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epochs_min</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">stop_criterion_window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">accuracy_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">train_loss_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hinge_loss_t</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">convergence</span><span class="o">=</span><span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">suppress_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_criteria</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">l2_reg</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">batch_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsample_by_freq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subsample_valid_test</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.DeepTCR_WF.Train--train-whole-sample-classifier">Train Whole-Sample Classifier</h5>
<p>This method trains the network and saves features values at the end of training for downstream analysis.</p>
<p>The method also saves the per sequence predictions at the end of training in the variable self.predicted</p>
<p>The two MIL options alter how the predictive signatures in the neural network are aggregated to make a prediction about the repertoire. If qualitative_agg or quantitative_agg are set to True, this will include these different types of aggregation in the predcitions. One can set either to True or both to True and this will allow a user to incorporate features from multiple modes of aggregation. See below for further details on these methods of aggregation across the sequences of a repertoire.</p>
<p>The multiesample parameters are used to implement Multi-Sample Dropout at the final layer of the model as described in "Multi-Sample Dropout for Accelerated Training and Better Generalization" https://arxiv.org/abs/1905.09788. This method has been shown to improve generalization of deep neural networks as well as improve convergence.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>kernel</strong> (<code>int</code>) – Size of convolutional kernel for first layer of convolutions.</p></li>
            <li><p><strong>num_concepts</strong> (<code>int</code>) – Number of concepts for multi-head attention mechanism. Depending on the expected heterogeneity of the repertoires being analyed, one can adjust this hyperparameter.</p></li>
            <li><p><strong>trainable_embedding</strong> (<code>bool</code>) – Toggle to control whether a trainable embedding layer is used or native one-hot representation for convolutional layers.</p></li>
            <li><p><strong>embedding_dim_aa</strong> (<code>int</code>) – Learned latent dimensionality of amino-acids.</p></li>
            <li><p><strong>embedding_dim_genes</strong> (<code>int</code>) – Learned latent dimensionality of VDJ genes</p></li>
            <li><p><strong>embedding_dim_hla</strong> (<code>int</code>) – Learned latent dimensionality of HLA</p></li>
            <li><p><strong>num_fc_layers</strong> (<code>int</code>) – Number of fully connected layers following convolutional layer.</p></li>
            <li><p><strong>units_fc</strong> (<code>int</code>) – Number of nodes per fully-connected layers following convolutional layer.</p></li>
            <li><p><strong>weight_by_class</strong> (<code>bool</code>) – Option to weight loss by the inverse of the class frequency. Useful for unbalanced classes.</p></li>
            <li><p><strong>class_weights</strong> (<code>dict</code>) – In order to specify custom weights for each class during training, one can provide a dictionary with these weights. i.e. {'A':1.0,'B':2.0'}</p></li>
            <li><p><strong>use_only_seq</strong> (<code>bool</code>) – To only use sequence feaures, set to True. This will turn off features learned from gene usage.</p></li>
            <li><p><strong>use_only_gene</strong> (<code>bool</code>) – To only use gene-usage features, set to True. This will turn off features from the sequences.</p></li>
            <li><p><strong>use_only_hla</strong> (<code>bool</code>) – To only use hla feaures, set to True.</p></li>
            <li><p><strong>size_of_net</strong> (<code>list or str</code>) – The convolutional layers of this network have 3 layers for which the use can modify the number of neurons per layer. The user can either specify the size of the network with the following options:</p>
<ul>
<li>small == [12,32,64] neurons for the 3 respective layers</li>
<li>medium == [32,64,128] neurons for the 3 respective layers</li>
<li>large == [64,128,256] neurons for the 3 respective layers</li>
<li>custom, where the user supplies a list with the number of nuerons for the respective layers
    i.e. [3,3,3] would have 3 neurons for all 3 layers.
    One can also adjust the number of layers for the convolutional stack by changing the length of
    this list. [3,3,3] = 3 layers, [3,3,3,3] = 4 layers.</li>
</ul></li>
            <li><p><strong>graph_seed</strong> (<code>int</code>) – For deterministic initialization of weights of the graph, set this to value of choice.</p></li>
            <li><p><strong>qualitative_agg</strong> (<code>bool</code>) – If set to True, the model will aggregate the feature values per repertoire weighted by frequency of each TCR. This is considered a 'qualitative' aggregation as the prediction of the repertoire is based on the relative distribution of the repertoire. In other words, this type of aggregation is a count-independent measure of aggregation. This is the mode of aggregation that has been more thoroughly tested across multiple scientific examples.</p></li>
            <li><p><strong>quantitative_agg</strong> (<code>bool</code>) – If set to True, the model will aggregate the feature values per repertoire weighted by counts of each TCR. This is considered a 'quantitative' aggregation as the prediction of the repertoire is based on teh absolute distribution of the repertoire. In other words, this type of aggregation is a count-dependent measure of aggregation. If one believes the counts are important for the predictive value of the model, one can set this parameter to True.</p></li>
            <li><p><strong>num_agg_layers</strong> (<code>int</code>) – Following the aggregation layer in the network, one can choose to add more fully-connected layers before the final classification layer. This parameter will set how many layers to add after aggregation. This likely is helpful when using both types of aggregation (as detailed above) to combine those feature values.</p></li>
            <li><p><strong>units_agg</strong> (<code>int</code>) – For the fully-connected layers after aggregation, this parameter sets the number of units/nodes per layer.</p></li>
            <li><p><strong>drop_out_rate</strong> (<code>float</code>) – drop out rate for fully connected layers</p></li>
            <li><p><strong>multisample_dropout_rate</strong> (<code>float</code>) – The dropout rate for this multi-sample dropout layer.</p></li>
            <li><p><strong>multisample_dropout_num_masks</strong> (<code>int</code>) – The number of masks to sample from for the Multi-Sample Dropout layer.</p></li>
            <li><p><strong>batch_size</strong> (<code>int</code>) – Size of batch to be used for each training iteration of the net.</p></li>
            <li><p><strong>batch_size_update</strong> (<code>int</code>) – In the case that the size of the samples are very large, one may not want to update the weights of the network as often as batches are put onto the gpu. Therefore, if one wants to update the weights less often than how often the batches of data are put onto the gpu, one can set this parameter to something other than None. An example would be if batch_size is set to 5 and batch_size_update is set to 30, while only 5 samples will be put on the gpu at a time, the weights will only be updated after 30 samples have been put on the gpu. This parameter is only relevant when using gpu's for training and there are memory constraints from very large samples.</p></li>
            <li><p><strong>epochs_min</strong> (<code>int</code>) – Minimum number of epochs for training neural network.</p></li>
            <li><p><strong>stop_criterion</strong> (<code>float</code>) – Minimum percent decrease in determined interval (below) to continue training. Used as early stopping criterion.</p></li>
            <li><p><strong>stop_criterion_window</strong> (<code>int</code>) – The window of data to apply the stopping criterion.</p></li>
            <li><p><strong>accuracy_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training accuracy is achieved, at which point, training ceases.</p></li>
            <li><p><strong>train_loss_min</strong> (<code>float</code>) – Optional parameter to allow alternative training strategy until minimum training loss is achieved, at which point, training ceases.</p></li>
            <li><p><strong>hinge_loss_t</strong> (<code>float</code>) – The per sample loss minimum at which the loss of that sample is not used to penalize the model anymore. In other words, once a per sample loss has hit this value, it gets set to 0.0.</p></li>
            <li><p><strong>convergence</strong> (<code>str</code>) – This parameter determines which loss to assess the convergence criteria on. Options are 'validation' or 'training'. This is useful in the case one wants to change the convergence criteria on the training data when the training and validation partitions have been combined and used to training the model.</p></li>
            <li><p><strong>learning_rate</strong> (<code>float</code>) – The learning rate for training the neural network. Making this value larger will increase the rate of convergence but can introduce instability into training. For most, altering this value will not be necessary.</p></li>
            <li><p><strong>suppress_output</strong> (<code>bool</code>) – To suppress command line output with training statisitcs, set to True.</p></li>
            <li><p><strong>l2_reg</strong> (<code>float</code>) – When training the repertoire classifier, it may help to utilize L2 regularization to prevent sample-specific overfitting of the model. By setting the value of this parameter (i.e. 0.01), one will introduce L2 regularization through all but the last layer of the network.</p></li>
            <li><p><strong>batch_seed</strong> (<code>int</code>) – For deterministic batching during training, set this value to an integer of choice.</p></li>
            <li><p><strong>subsample</strong> (<code>int</code>) – Number of sequences to sub-sample from repertoire during training to improve speed of convergence as well as being a form of regularization.</p></li>
            <li><p><strong>subsample_by_freq</strong> (<code>bool</code>) – Whether to sub-sample randomly in the repertoire or as a function of the frequency of the TCR.</p></li>
            <li><p><strong>subsample_valid_test</strong> (<code>bool</code>) – Whether to sub-sample during valid/test cohorts while training. This is mostly as well to improve speed to convergence and generalizability.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="DeepTCR.DeepTCR.feature_analytics_class" class="doc doc-heading">
        <code>feature_analytics_class</code>



</h3>

    <div class="doc doc-contents ">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.feature_analytics_class.Cluster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">clustering_method</span><span class="o">=</span><span class="s1">&#39;phenograph&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">linkage_method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">,</span> <span class="n">write_to_sheets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">order_by_linkage</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.feature_analytics_class.Cluster--clustering-sequences-by-latent-features">Clustering Sequences by Latent Features</h5>
<p>This method clusters all sequences by learned latent features from either the variational autoencoder or by the supervised methods. Several clustering algorithms are included including Phenograph, DBSCAN, or hierarchical clustering. DBSCAN is implemented from the sklearn package. Hierarchical clustering is implemented from the scipy package.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>set</strong> (<code>str</code>) – To choose which set of sequences to analye, enter either 'all','train', 'valid',or 'test'. Since the sequences in the train set may be overfit, it preferable to generally examine the test set on its own.</p></li>
            <li><p><strong>clustering_method</strong> (<code>str</code>) – Clustering algorithm to use to cluster TCR sequences. Options include phenograph, dbscan, or hierarchical. When using dbscan or hierarchical clustering, a variety of thresholds are used to find an optimimum silhoutte score before using a final clustering threshold when t value is not provided.</p></li>
            <li><p><strong>t</strong> (<code>float</code>) – If t is provided, this is used as a distance threshold for hierarchical clustering or the eps value for dbscan.</p></li>
            <li><p><strong>criterion</strong> (<code>str</code>) – Clustering criterion as allowed by fcluster function in scipy.cluster.hierarchy module. (Used in hierarchical clustering).</p></li>
            <li><p><strong>linkage_method</strong> (<code>str</code>) – method parameter for linkage as allowed by scipy.cluster.hierarchy.linkage</p></li>
            <li><p><strong>write_to_sheets</strong> (<code>bool</code>) – To write clusters to separate csv files in folder named 'Clusters' under results folder, set to True. Additionally, if set to True, a csv file will be written in results directory that contains the frequency contribution of each cluster to each sample.</p></li>
            <li><p><strong>sample</strong> (<code>int</code>) – For large numbers of sequences, to obtain a faster clustering solution, one can sub-sample a number of sequences and then use k-nearest neighbors to assign other sequences.</p></li>
            <li><p><strong>n_jobs</strong> (<code>int</code>) – Number of processes to use for parallel operations.</p></li>
            <li><p><strong>order_by_linkage</strong> (<code>bool</code>) – To list sequences in the cluster dataframes by how they are related via ward's linakge, set this value to True. Otherwise, each cluster dataframe will list the sequences by the order they were loaded into DeepTCR.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Cluster Results</p>
<ul>
<li>self.Cluster_DFs (list of Pandas dataframes)` – Clusters by sequences/label</li>
<li>self.var (list): Variance of lengths in each cluster</li>
<li>self.Cluster_Frequencies (Pandas dataframe): A dataframe containing the frequency contribution of each cluster to each sample.</li>
<li>self.Cluster_Assignments (ndarray): Array with cluster assignments by number.</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.feature_analytics_class.Motif_Identification" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Motif_Identification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">p_val_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">by_samples</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">top_seq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.feature_analytics_class.Motif_Identification--motif-identification-supervised-classifiers">Motif Identification Supervised Classifiers</h5>
<p>This method looks for enriched features in the predetermined group and returns fasta files in directory to be used with "https://weblogo.berkeley.edu/logo.cgi" to produce seqlogos.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>group</strong> (<code>string</code>) – Class for analyzing enriched motifs.</p></li>
            <li><p><strong>p_val_threshold</strong> (<code>float</code>) – Significance threshold for enriched features/motifs for Mann-Whitney UTest.</p></li>
            <li><p><strong>by_samples</strong> (<code>bool</code>) – To run a motif identification that looks for enriched motifs at the sample instead of the seuence level, set this parameter to True. Otherwise, the enrichment analysis will be done at the sequence level.</p></li>
            <li><p><strong>top_seq</strong> (<code>int</code>) – The number of sequences from which to derive the learned motifs. The larger the number, the more noisy the motif logo may be.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Output</p>
<ul>
<li>self.(alpha/beta)_group_features (Pandas Dataframe)` – Sequences used to determine motifs in fasta files
are stored in this dataframe where column names represent
the feature number.</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.feature_analytics_class.Sample_Features" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Sample_Features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">Weight_by_Freq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.feature_analytics_class.Sample_Features--sample-level-feature-values">Sample-Level Feature Values</h5>
<p>This method returns a dataframe with the aggregate sample level features.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>set</strong> (<code>str</code>) – To choose which set of sequences to analye, enter either 'all','train', 'valid',or 'test'. Since the sequences in the train set may be overfit, it preferable to generally examine the test set on its own.</p></li>
            <li><p><strong>Weight_by_Freq</strong> (<code>bool</code>) – Option to weight each sequence used in aggregate measure of feature across sample by its frequency.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Sample Level Features</p>
<ul>
<li>self.sample_featres (pandas dataframe)` – This function returns the average feature vector for each sample analyzed. This can be used to make further downstream comparisons such as inter-repertoire distances.</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>      <hr />

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.feature_analytics_class.Structural_Diversity" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Structural_Diversity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.feature_analytics_class.Structural_Diversity--structural-diversity-measurements">Structural Diversity Measurements</h5>
<p>This method first clusters sequences via the phenograph algorithm before computing
the number of clusters and entropy of the data over these clusters to obtain a measurement
of the structural diversity within a repertoire.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>sample</strong> (<code>int</code>) – For large numbers of sequences, to obtain a faster clustering solution, one can sub-sample</p></li>
            <li><p><strong>n_jobs</strong> (<code>int</code>) – Number of processes to use for parallel operations.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Diversity dataframe</p>
<ul>
<li>self.Structural_Diversity_DF (Pandas dataframe)` – A dataframe containing the number of clusters and entropy in each sample</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="DeepTCR.DeepTCR.vis_class" class="doc doc-heading">
        <code>vis_class</code>



</h3>

    <div class="doc doc-contents ">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.vis_class.HeatMap_Samples" class="doc doc-heading">
<code class="highlight language-python"><span class="n">HeatMap_Samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Heatmap_Samples.tif&#39;</span><span class="p">,</span> <span class="n">Weight_by_Freq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.vis_class.HeatMap_Samples--heatmap-of-samples">HeatMap of Samples</h5>
<p>This method creates a heatmap/clustermap for samples by latent features for the unsupervised deep learning methods.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>set</strong> (<code>str</code>) – To choose which set of sequences to analye, enter either 'all','train', 'valid',or 'test'. Since the sequences in the train set may be overfit, it preferable to generally examine the test set on its own.</p></li>
            <li><p><strong>filename</strong> (<code>str</code>) – Name of file to save heatmap.</p></li>
            <li><p><strong>Weight_by_Freq</strong> (<code>bool</code>) – Option to weight each sequence used in aggregate measure of feature across sample by its frequency.</p></li>
            <li><p><strong>color_dict</strong> (<code>dict</code>) – Optional dictionary to provide specified colors for classes.</p></li>
            <li><p><strong>labels</strong> (<code>bool</code>) – Option to show names of samples on y-axis of heatmap.</p></li>
            <li><p><strong>font_scale</strong> (<code>float</code>) – This parameter controls the font size of the row labels. If there are many rows, one can make this value smaller to get better labeling of the rows.</p></li>
            <li><p><strong>figsize</strong> (<code>tuple</code>) – This parameter controls the size of the figure.</p></li>
            <li><p><strong>legend</strong> (<code>bool</code>) – Whether to show legend for class labels</p></li>
            <li><p><strong>legend_size</strong> (<code>int</code>) – Size of legend.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Sample Features</p>
<ul>
<li>self.sample_features (pandas dataframe)` – This function returns the average feature vector for each sample analyzed. This can be used to make further downstream comparisons such as inter-repertoire distances.</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.vis_class.HeatMap_Sequences" class="doc doc-heading">
<code class="highlight language-python"><span class="n">HeatMap_Sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Heatmap_Sequences.tif&#39;</span><span class="p">,</span> <span class="n">sample_num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_num_per_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.vis_class.HeatMap_Sequences--heatmap-of-sequences">HeatMap of Sequences</h5>
<p>This method creates a heatmap/clustermap for sequences by latent features for the unsupervised deep lerning methods.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>set</strong> (<code>str</code>) – To choose which set of sequences to analye, enter either 'all','train', 'valid',or 'test'. Since the sequences in the train set may be overfit, it preferable to generally examine the test set on its own.</p></li>
            <li><p><strong>filename</strong> (<code>str</code>) – Name of file to save heatmap.</p></li>
            <li><p><strong>sample_num</strong> (<code>int</code>) – Number of events to randomly sample for heatmap.</p></li>
            <li><p><strong>sample_num_per_class</strong> (<code>int</code>) – Number of events to randomly sample per class for heatmap.</p></li>
            <li><p><strong>color_dict</strong> (<code>dict</code>) – Optional dictionary to provide specified colors for classes.</p></li>
            <li><p><strong>figsize</strong> (<code>tuple</code>) – This parameter controls the size of the figure.</p></li>
            <li><p><strong>legend</strong> (<code>bool</code>) – Whether to show legend for class labels</p></li>
            <li><p><strong>legend_size</strong> (<code>int</code>) – Size of legend.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.vis_class.Repertoire_Dendrogram" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Repertoire_Dendrogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">distance_metric</span><span class="o">=</span><span class="s1">&#39;KL&#39;</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dendrogram_radius</span><span class="o">=</span><span class="mf">0.32</span><span class="p">,</span> <span class="n">repertoire_radius</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linkage_method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">,</span> <span class="n">gridsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">Load_Prev_Data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gaussian_sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">n_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.vis_class.Repertoire_Dendrogram--repertoire-dendrogram">Repertoire Dendrogram</h5>
<p>This method creates a visualization that shows and compares the distribution of the sample repertoires via UMAP and provided distance metric. The underlying algorithm first applied phenograph clustering to determine the proportions of the sample within a given cluster. Then a distance metric is used to compare how far two samples are based on their cluster proportions. Various metrics can be provided here such as KL-divergence, Correlation, and Euclidean.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>set</strong> (<code>str</code>) – To choose which set of sequences to analye, enter either 'all','train', 'valid',or 'test'. Since the sequences in the train set may be overfit, it preferable to generally examine the test set on its own.</p></li>
            <li><p><strong>distance_metric</strong> (<code>str</code>) – Provided distance metric to determine repertoire-level distance from cluster proportions. Options include = (KL,correlation,euclidean,wasserstein,JS).</p></li>
            <li><p><strong>sample</strong> (<code>int</code>) – For large numbers of sequences, to obtain a faster clustering solution, one can sub-sample a number of sequences and then use k-nearest neighbors to assign other sequences.</p></li>
            <li><p><strong>n_jobs</strong> (<code>int</code>) – Number of processes to use for parallel operations.</p></li>
            <li><p><strong>color_dict</strong> (<code>dict</code>) – Optional dictionary to provide specified colors for classes.</p></li>
            <li><p><strong>dendrogram_radius</strong> (<code>float</code>) – The radius of the dendrogram in the figure. This will usually require some adjustment given the number of samples.</p></li>
            <li><p><strong>repertoire_radius</strong> (<code>float</code>) – The radius of the repertoire plots in the figure. This will usually require some adjustment given the number of samples.</p></li>
            <li><p><strong>linkage_method</strong> (<code>str</code>) – linkage method used by scipy's linkage function</p></li>
            <li><p><strong>gridsize</strong> (<code>int</code>) – This parameter modifies the granularity of the hexbins for the repertoire density plots.</p></li>
            <li><p><strong>Load_Prev_Data</strong> (<code>bool</code>) – If method has been run before, one can load previous data used to construct the figure for faster figure creation. This is helpful when trying to format the figure correctly and will require the user to run the method multiple times.</p></li>
            <li><p><strong>filename</strong> (<code>str</code>) – To save dendrogram plot to results folder, enter a name for the file and the dendrogram will be saved to the results directory. i.e. dendrogram.png</p></li>
            <li><p><strong>sample_labels</strong> (<code>bool</code>) – To show the sample labels on the dendrogram, set to True.</p></li>
            <li><p><strong>gaussian_sigma</strong> (<code>float</code>) – The amount of blur to introduce in the plots.</p></li>
            <li><p><strong>vmax</strong> (<code>float</code>) – Highest color density value. Color scales from 0 to vmax (i.e. larger vmax == dimmer plot)</p></li>
            <li><p><strong>lw</strong> (<code>float</code>) – The width of the circle edge around each sample.</p></li>
            <li><p><strong>log_scale</strong> (<code>bool</code>) – To plot the log of the counts for the UMAP density plot, set this value to True. This can be particularly helpful for visualization if the populations are very clonal.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>`Output</p>
<ul>
<li>self.pairwise_distances (Pandas dataframe)` – Pairwise distances of all samples</li>
</ul></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>      <hr />

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.vis_class.UMAP_Plot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">UMAP_Plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by_cluster</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">freq_weight</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">Load_Prev_Data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_per_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prob_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_by_class</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.vis_class.UMAP_Plot--umap-visualization-of-tcr-sequences">UMAP visualization of TCR Sequences</h5>
<p>This method displays the sequences in a 2-dimensional UMAP where the user can color code points by class label, sample label, or prior computing clustering solution. Size of points can also be made to be proportional to frequency of sequence within sample.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>set</strong> (<code>str</code>) – To choose which set of sequences to analye, enter either 'all','train', 'valid',or 'test'. Since the sequences in the train set may be overfit, it preferable to generally examine the test set on its own.</p></li>
            <li><p><strong>by_class</strong> (<code>bool</code>) – To color the points by their class label, set to True.</p></li>
            <li><p><strong>by_sample</strong> (<code>bool</code>) – To color the points by their sample lebel, set to True.</p></li>
            <li><p><strong>by_cluster</strong> (<code>bool</code>) – To color the points by the prior computed clustering solution, set to True.</p></li>
            <li><p><strong>freq_weight</strong> (<code>bool</code>) – To scale size of points proportionally to their frequency, set to True.</p></li>
            <li><p><strong>show_legend</strong> (<code>bool</code>) – To display legend, set to True.</p></li>
            <li><p><strong>scale</strong> (<code>float</code>) – To change size of points, change scale parameter. Is particularly useful when finding good display size when points are scaled by frequency.</p></li>
            <li><p><strong>Load_Prev_Data</strong> (<code>bool</code>) – If method was run before, one can rerun this method with this parameter set to True to bypass recomputing the UMAP projection. Useful for generating different versions of the plot on the same UMAP representation.</p></li>
            <li><p><strong>alpha</strong> (<code>float</code>) – Value between 0-1 that controls transparency of points.</p></li>
            <li><p><strong>sample</strong> (<code>int</code>) – Number of events to sub-sample for visualization.</p></li>
            <li><p><strong>sample_per_class</strong> (<code>int</code>) – Number of events to randomly sample per class for UMAP.</p></li>
            <li><p><strong>filename</strong> (<code>str</code>) – To save umap plot to results folder, enter a name for the file and the umap will be saved to the results directory. i.e. umap.png</p></li>
            <li><p><strong>prob_plot</strong> (<code>str</code>) – To plot the predicted probabilities for the sequences as an additional heatmap, specify the class probability one wants to visualize (i.e. if the class of interest is class A, input 'A' as a string). Of note, only probabilities determined from the sequences in the test set are displayed as a means of not showing over-fit probabilities. Therefore, it is best to use this parameter when the set parameter is turned to 'test'.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="DeepTCR.DeepTCR.vis_class.UMAP_Plot_Samples" class="doc doc-heading">
<code class="highlight language-python"><span class="n">UMAP_Plot_Samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;UMAP_Samples.tif&#39;</span><span class="p">,</span> <span class="n">Weight_by_Freq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <h5 id="DeepTCR.DeepTCR.vis_class.UMAP_Plot_Samples--umap-visualization-of-tcr-samples">UMAP visualization of TCR Samples</h5>
<p>This method displays the samples in a 2-dimensional UMAP</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>set</strong> (<code>str</code>) – To choose which set of sequences to analye, enter either 'all','train', 'valid',or 'test'. Since the sequences in the train set may be overfit, it preferable to generally examine the test set on its own.</p></li>
            <li><p><strong>Weight_by_Freq</strong> (<code>bool</code>) – Option to weight each sequence used in aggregate measure of feature across sample by its frequency.</p></li>
            <li><p><strong>scale</strong> (<code>float</code>) – To change size of points, change scale parameter.</p></li>
            <li><p><strong>alpha</strong> (<code>float</code>) – Value between 0-1 that controls transparency of points.</p></li>
            <li><p><strong>filename</strong> (<code>str</code>) – To save umap plot to results folder, enter a name for the file and the umap will be saved to the results directory. i.e. umap.png</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../releasehx/" class="btn btn-neutral float-right" title="Release History">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../releasehx/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
